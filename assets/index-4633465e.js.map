{"version":3,"mappings":"y8BAEO,MAAMA,UAAkBC,OAAM,CACnC,aAAc,CACN,OAAE,IAAK,YAAa,CAC5B,CAEA,SAAgB,CACd,QAAQ,IAAI,yCAAyC,EAGrD,KAAK,gBAAgB,EAGrB,KAAK,KAAK,MAAM,SAAU,6BAA+B,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA,KAK7D,CAAC,EAEF,KAAK,KAAK,MAAM,eAAgB,6BAA+B,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAMnE,CAAC,EAEF,KAAK,KAAK,MAAM,eAAgB,6BAA+B,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAMnE,CAAC,EAGG,UAAK,MAAM,UAAW,yBAAyB,EAC/C,UAAK,MAAM,UAAW,yBAAyB,EAC/C,UAAK,MAAM,aAAc,4BAA4B,EAE1D,KAAK,KAAK,MAAM,SAAU,6BAA+B,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA,KAK7D,CAAC,EAEF,KAAK,KAAK,MAAM,aAAc,6BAA+B,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAUjE,CAAC,CACJ,CAEA,QAAe,CACb,QAAQ,IAAI,wDAAwD,EAGpE,KAAK,QAAQ,KAAK,QAAQ,IAAK,EAAG,EAAG,CAAC,EACtC,KAAK,QAAQ,KAAK,KAAK,wBAAyB,IAAM,CAC/C,WAAM,MAAM,WAAW,EAC7B,CACH,CAEQ,iBAAwB,CAC9B,KAAM,CAAE,MAAAC,EAAO,OAAAC,CAAO,EAAI,KAAK,QAAQ,KAGjCC,EAAc,KAAK,IAAI,KAAKF,EAAQ,EAAGC,EAAS,EAAI,GAAI,aAAc,CAC1E,SAAU,OACV,MAAO,UACP,WAAY,QACb,EAAE,UAAU,EAAG,EAGVE,EAAa,KAAK,IAAI,SAAS,EAC1BA,EAAA,UAAU,EAAU,EAAG,EAClCA,EAAW,SAASH,EAAQ,EAAI,IAAKC,EAAS,EAAG,IAAK,EAAE,EAGlD,MAAAG,EAAc,KAAK,IAAI,SAAS,EAGtC,KAAK,KAAK,GAAG,WAAaC,GAAkB,CAC1CD,EAAY,MAAM,EAClBA,EAAY,UAAU,KAAQ,EAClBA,EAAA,SAASJ,EAAQ,EAAI,IAAKC,EAAS,EAAG,IAAMI,EAAO,EAAE,EAClE,EAEI,UAAK,GAAG,WAAY,IAAM,CAC7BH,EAAY,QAAQ,QAAQ,EAC5BE,EAAY,MAAM,EAClBD,EAAW,MAAM,EAClB,CACH,CACF,CCbO,MAAMG,EAAe,CAC1B,GAAI,CAEF,MAAO,wBACP,SAAU,6BACV,QAAS,8BACT,QAAS,WACT,MAAO,QACP,OAAQ,SACR,aAAc,eACd,SAAU,YACV,aAAc,yBACd,eAAgB,gDAGhB,kBAAmB,kBACnB,sBAAuB,wDACvB,qBAAsB,gBACtB,kBAAmB,iBACnB,iBAAkB,WAClB,qBAAsB,gBACtB,sBAAuB,+BACvB,sBAAuB,uCACvB,wBAAyB,4CACzB,yBAA0B,iCAC1B,yBAA0B,sDAC1B,yBAA0B,6CAC1B,kBAAmB,wBACnB,kBAAmB,yBACnB,uBAAwB,sDACxB,wBAAyB,qDACzB,sBAAuB,2CAGvB,MAAO,QACP,MAAO,QACP,KAAM,OACN,QAAS,WACT,iBAAkB,6CAClB,UAAW,qFACX,SAAU,aACV,WAAY,cACZ,eAAgB,8BAGhB,YAAa,uCACb,iBAAkB,yCAClB,mBAAoB,uBACpB,kBAAmB,sBACnB,eAAgB,wBAChB,kBAAmB,qCACnB,aAAc,YACd,SAAU,SACV,gBAAiB,6BACjB,mBAAoB,wCACpB,WAAY,SACZ,iBAAkB,wBAClB,oBAAqB,wCACrB,wBAAyB,gBACzB,qBAAsB,mDACtB,iBAAkB,iBAClB,eAAgB,gBAChB,qBAAsB,iBACtB,mBAAoB,SAGpB,iBAAkB,qCAClB,aAAc,wCACd,gBAAiB,4BACjB,eAAgB,6CAChB,WAAY,0CACZ,oBAAqB,yCACrB,iBAAkB,wBAClB,eAAgB,mCAChB,iBAAkB,uCAClB,kBAAmB,2BAGnB,cAAe,sBACf,iBAAkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAClB,oBAAqB;AAAA;AAAA;AAAA,0BACrB,cAAe,oEACf,gBAAiB,sDAGjB,wBAAyB,iDACzB,iBAAkB,UAClB,iBAAkB,UAClB,oBAAqB,YACvB,EAEA,GAAI,CAEF,MAAO,wBACP,SAAU,kCACV,QAAS,+BACT,QAAS,gBACT,MAAO,QACP,OAAQ,WACR,aAAc,aACd,SAAU,YACV,aAAc,yBACd,eAAgB,sDAGhB,kBAAmB,mBACnB,sBAAuB,mEACvB,qBAAsB,iBACtB,kBAAmB,uBACnB,iBAAkB,mBAClB,qBAAsB,oBACtB,sBAAuB,mCACvB,sBAAuB,6CACvB,wBAAyB,8CACzB,yBAA0B,yCAC1B,yBAA0B,gEAC1B,yBAA0B,gDAC1B,kBAAmB,kBACnB,kBAAmB,6BACnB,uBAAwB,qEACxB,wBAAyB,yEACzB,sBAAuB,uDAGvB,MAAO,YACP,MAAO,OACP,KAAM,QACN,QAAS,WACT,iBAAkB,mDAClB,UAAW,8FACX,SAAU,aACV,WAAY,mBACZ,eAAgB,0CAGhB,YAAa,yCACb,iBAAkB,6CAClB,mBAAoB,sBACpB,kBAAmB,qBACnB,eAAgB,sBAChB,kBAAmB,qCACnB,aAAc,eACd,SAAU,aACV,gBAAiB,kCACjB,mBAAoB,iDACpB,WAAY,WACZ,iBAAkB,8BAClB,oBAAqB,uCACrB,wBAAyB,kBACzB,qBAAsB,wDACtB,iBAAkB,oBAClB,eAAgB,kBAChB,qBAAsB,gBACtB,mBAAoB,SAGpB,iBAAkB,sCAClB,aAAc,6CACd,gBAAiB,gCACjB,eAAgB,4CAChB,WAAY,kCACZ,oBAAqB,6CACrB,iBAAkB,6BAClB,eAAgB,uCAChB,iBAAkB,wCAClB,kBAAmB,oCAGnB,cAAe,uBACf,iBAAkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAClB,oBAAqB;AAAA;AAAA;AAAA,0BACrB,cAAe,uEACf,gBAAiB,gEAGjB,wBAAyB,uDACzB,iBAAkB,UAClB,iBAAkB,UAClB,oBAAqB,YACvB,CACF,EC5QaC,EAAN,MAAMA,CAAgB,CAKnB,aAAc,CAHdC,EAAA,uBAA4B,MAC5BA,EAAA,qBAAmD,KAInD,MAAAC,EAAgB,aAAa,QAAQ,iBAAiB,EACtDC,EAAkB,UAAU,SAAS,YAAY,EAEnDD,GAAiBA,KAAiBH,EACpC,KAAK,gBAAkBG,EACdC,EAAgB,WAAW,IAAI,EACxC,KAAK,gBAAkB,KAEvB,KAAK,gBAAkB,KAGzB,QAAQ,IAAI,4BAA4B,KAAK,eAAe,EAAE,CAChE,CAEA,OAAc,aAA+B,CACvC,OAACH,EAAgB,WACHA,EAAA,SAAW,IAAIA,GAE1BA,EAAgB,QACzB,CAEO,oBAA+B,CACpC,OAAO,KAAK,eACd,CAEO,YAAYI,EAA0B,CACvCA,IAAa,KAAK,iBAAmBA,KAAYL,IACnD,KAAK,gBAAkBK,EACV,qBAAQ,kBAAmBA,CAAQ,EAExC,YAAI,2BAA2BA,CAAQ,EAAE,EAGjD,KAAK,UAAU,QAAoBC,KAASD,CAAQ,CAAC,EAEzD,CAEO,gBAA8B,CAC5B,OAAAL,EAAa,KAAK,eAAe,CAC1C,CAEO,UAAUO,EAAgC,CAC/C,OAAOP,EAAa,KAAK,eAAe,EAAEO,CAAG,CAC/C,CAEO,iBAAiBD,EAA8C,CAC/D,eAAU,IAAIA,CAAQ,CAC7B,CAEO,kBAAkBA,EAA8C,CAChE,eAAU,OAAOA,CAAQ,CAChC,CAEO,gBAAuB,CAC5B,MAAME,EAAwB,KAAK,kBAAoB,KAAO,KAAO,KACrE,KAAK,YAAYA,CAAW,CAC9B,CAEO,uBAAoC,CAClC,cAAO,KAAKR,CAAY,CACjC,CAEO,uBAAuBK,EAA4B,CACxD,OAAQA,EAAU,CAChB,IAAK,KAAa,gBAClB,IAAK,KAAa,iBAClB,QAAgB,OAAAA,CAClB,CACF,CACF,EA3EEH,EADWD,EACI,YADV,IAAMQ,EAANR,EA+EM,MAAAS,EAAkBD,EAAgB,YAAY,ECtE9CE,EAAN,MAAMA,CAAiB,CAKpB,aAAc,CAHdT,EAAA,wBAA8B,WAC9BA,EAAA,qBAAqD,KAIvD,IAAAU,EAAiB,aAAa,QAAQ,kBAAkB,EAGxDA,IAAmB,cACJA,EAAA,aACJ,qBAAQ,mBAAoBA,CAAc,EACvD,QAAQ,IAAI,wDAAwD,GAGlEA,GAAkB,KAAK,iBAAiBA,CAAc,IACxD,KAAK,iBAAmBA,GAG1B,QAAQ,IAAI,6BAA6B,KAAK,gBAAgB,EAAE,CAClE,CAEA,OAAc,aAAgC,CACxC,OAACD,EAAiB,WACHA,EAAA,SAAW,IAAIA,GAE3BA,EAAiB,QAC1B,CAEQ,iBAAiBE,EAA2C,CAClE,MAAO,CAAC,UAAW,UAAW,YAAY,EAAE,SAASA,CAAS,CAChE,CAEO,qBAAiC,CACtC,OAAO,KAAK,gBACd,CAEO,aAAaA,EAA4B,CAC1CA,IAAc,KAAK,kBAAoB,KAAK,iBAAiBA,CAAS,IACxE,KAAK,iBAAmBA,EACX,qBAAQ,mBAAoBA,CAAS,EAE1C,YAAI,4BAA4BA,CAAS,EAAE,EAGnD,KAAK,UAAU,QAAoBP,KAASO,CAAS,CAAC,EAE1D,CAEO,iBAAiBA,EAAsC,CACtD,MAAAC,EAAOD,GAAa,KAAK,iBACzBE,EAAIL,EAAgB,iBAE1B,OAAQI,EAAM,CACZ,IAAK,UACI,OACL,GAAI,UACJ,KAAMC,EAAE,iBACR,OAAQ,UACR,YAAa,0BAEjB,IAAK,UACI,OACL,GAAI,UACJ,KAAMA,EAAE,iBACR,OAAQ,UACR,YAAa,2BAEjB,IAAK,aACI,OACL,GAAI,aACJ,KAAMA,EAAE,oBACR,OAAQ,aACR,YAAa,8BAEjB,QACS,YAAK,iBAAiB,SAAS,CAC1C,CACF,CAEO,yBAAkC,CAChC,YAAK,iBAAmB,MACjC,CAEO,kBAAoC,CAClC,OAAC,UAAW,UAAW,YAAY,EAAE,IAAYD,GAAA,KAAK,iBAAiBA,CAAiB,CAAC,CAClG,CAEO,kBAAkBR,EAAgD,CAClE,eAAU,IAAIA,CAAQ,CAC7B,CAEO,mBAAmBA,EAAgD,CACnE,eAAU,OAAOA,CAAQ,CAChC,CAEO,gBAAuB,CAC5B,MAAMU,EAA0B,CAAC,UAAW,UAAW,YAAY,EAE7DC,GADeD,EAAW,QAAQ,KAAK,gBAAgB,EAC3B,GAAKA,EAAW,OAC7C,kBAAaA,EAAWC,CAAS,CAAC,CACzC,CACF,EAtGEf,EADWS,EACI,YADV,IAAMO,EAANP,EA0GM,MAAAQ,EAAmBD,EAAiB,YAAY,ECjHtD,MAAME,UAAkB3B,OAAM,CAwBnC,aAAc,CACN,OAAE,IAAK,YAAa,EAxBpBS,EAAA,kBACAA,EAAA,gBACAA,EAAA,iBACAA,EAAA,aAAgB,GAChBA,EAAA,aAAgB,GAChBA,EAAA,gBAAmB,IACnBA,EAAA,kBACAA,EAAA,kBACAA,EAAA,kBACAA,EAAA,oBACAA,EAAA,yBACAA,EAAA,kBACAA,EAAA,+BACAA,EAAA,mBACAA,EAAA,qBACAA,EAAA,kBACAA,EAAA,qBACAA,EAAA,mBAAuB,IACvBA,EAAA,gBAAoB,IACpBA,EAAA,mBAAuB,IACvBA,EAAA,uBAA0B,GAC1BA,EAAA,qBAA2C,GAInD,CAEA,QAAe,CACb,QAAQ,IAAI,oCAAoC,EAGhD,KAAM,CAAE,MAAAR,EAAO,OAAAC,CAAO,EAAI,KAAK,QAAQ,KACvC,KAAK,IAAI,MAAMD,EAAQ,EAAGC,EAAS,EAAG,YAAY,EAElD,KAAK,QAAQ,EACb,KAAK,iBAAiB,EACtB,KAAK,WAAW,EAChB,KAAK,gBAAgB,EAGrB,KAAK,QAAQ,KAAK,OAAO,IAAK,EAAG,EAAG,CAAC,EAErC,QAAQ,IAAI,6BAA6B,CAC3C,CAEQ,SAAgB,CACtB,KAAM,CAAE,MAAAD,EAAO,OAAAC,CAAO,EAAI,KAAK,QAAQ,KACjCoB,EAAIL,EAAgB,iBAGrB,eAAY,KAAK,IAAI,KAAK,GAAI,GAAI,GAAGK,EAAE,KAAK,MAAO,CACtD,SAAU,OACV,MAAO,UACP,WAAY,QACb,EAGI,eAAY,KAAK,IAAI,KAAK,GAAI,GAAI,GAAGA,EAAE,KAAK,WAAY,CAC3D,SAAU,OACV,MAAO,UACP,WAAY,QACb,EAGI,eAAY,KAAK,IAAI,KAAKrB,EAAQ,EAAG,GAAI,GAAGqB,EAAE,IAAI,QAAS,CAC9D,SAAU,OACV,MAAO,UACP,WAAY,QACb,EAAE,UAAU,EAAG,EAGhB,KAAK,YAAc,KAAK,IAAI,KAAKrB,EAAQ,GAAI,GAAI,GAAI,CACnD,SAAU,OACV,MAAO,UACP,WAAY,OACb,GAAE,UAAU,EAAG,CAAC,EAGZ,sBAAmB,KAAK,IAAI,KAAKA,EAAQ,EAAGC,EAAS,IAAMoB,EAAE,iBAAkB,CAClF,SAAU,KAAK,IAAI,GAAIrB,EAAQ,IAAK,EAAI,KACxC,MAAO,UACP,WAAY,QACb,EAAE,UAAU,EAAG,EAEX,eAAY,KAAK,IAAI,KAAKA,EAAQ,EAAGC,EAAS,IAAMoB,EAAE,UAAW,CACpE,SAAU,KAAK,IAAI,GAAIrB,EAAQ,IAAK,EAAI,KACxC,MAAO,UACP,WAAY,QACb,EAAE,UAAU,EAAG,EAGhB,KAAK,uBAAyB,IAAM,CAClC,KAAK,cAAc,GAELgB,EAAA,iBAAiB,KAAK,sBAAsB,CAC9D,CAEQ,eAAsB,CACtB,MAAAK,EAAIL,EAAgB,iBAGrB,eAAU,QAAQ,GAAGK,EAAE,KAAK,KAAK,KAAK,KAAK,EAAE,EAGlD,MAAMM,EAAS,KAAK,OAAO,KAAK,KAAK,EACrC,KAAK,UAAU,QAAQ,GAAGN,EAAE,KAAK,KAAKM,CAAM,EAAE,EAGzC,eAAU,QAAQ,GAAGN,EAAE,IAAI,KAAK,KAAK,QAAQ,GAAG,EAGhD,sBAAiB,QAAQA,EAAE,gBAAgB,EAC3C,eAAU,QAAQA,EAAE,SAAS,EAG9B,KAAK,aACF,iBAAY,QAAQ,KAAKA,EAAE,OAAO,KAAK,KAAK,eAAe,GAAG,CAEvE,CAEQ,kBAAyB,CAC/B,KAAM,CAAE,MAAArB,EAAO,OAAAC,CAAO,EAAI,KAAK,QAAQ,KAGjC2B,EAAmBH,EAAiB,sBACrC,eAAY,KAAK,QAAQ,IAAI,MAAMzB,EAAQ,EAAGC,EAAS,GAAI2B,CAAgB,EAC3E,eAAU,sBAAsB,EAAI,EACpC,eAAU,aAAa,EAAI,EAG3B,eAAU,SAAS,EAAG,EAGVH,EAAA,kBAAmBI,GAAiB,CAC/C,KAAK,YACF,eAAU,WAAWA,CAAY,EAC9B,YAAI,mCAAmCA,CAAY,EAAE,EAC/D,CACD,EAGD,KAAK,QAAU,KAAK,QAAQ,IAAI,MAAM,CACpC,WAAY,SACZ,QAAS,GACV,EAGD,KAAK,SAAW,KAAK,QAAQ,IAAI,MAAM,CACrC,WAAY,eACZ,QAAS,EACV,CACH,CAEQ,YAAmB,QAETC,EAAA,KAAK,MAAM,WAAX,MAAAA,EAAqB,mBAMrC,KAAK,MAAM,GAAG,cAAgBC,GAAkC,CAC9D,GAAIA,EAAQ,OAAQ,CAClB,KAAM,CAAE,MAAA/B,CAAU,OAAK,QAAQ,KACzBgC,EAAS,KAAK,IAAI,GAAIhC,EAAQ,GAAI,EACnC,eAAU,EAAI,OAAO,KAAK,MAAM+B,EAAQ,EAAGC,EAAQhC,EAAQgC,CAAM,CACxE,EACD,EAEI,WAAM,GAAG,cAAe,IAAM,CAE5B,KAAK,UACR,KAAK,UAAU,CACjB,CACD,CACH,CAEQ,iBAAwB,CAC9B,KAAK,QAAQ,IAAI,QACf,KAAK,UACL,KAAK,QACL,KAAK,YACL,OACA,MAGF,KAAK,QAAQ,IAAI,QACf,KAAK,UACL,KAAK,SACL,KAAK,aACL,OACA,KAEJ,CAEQ,WAAkB,CACxB,GAAI,KAAK,YAAa,OAGtB,KAAK,cAAc,QAAgBC,KAAK,SAAS,EACjD,KAAK,cAAgB,GAGrB,KAAK,MAAQ,EACb,KAAK,MAAQ,EACb,KAAK,SAAW,GAChB,KAAK,SAAW,GAChB,KAAK,YAAc,GACnB,KAAK,gBAAkB,EAGvB,KAAK,mBAAmB,EAClB,MAAAZ,EAAIL,EAAgB,iBACrB,eAAU,QAAQ,GAAGK,EAAE,KAAK,KAAK,KAAK,KAAK,EAAE,EAC7C,eAAU,QAAQ,GAAGA,EAAE,IAAI,KAAK,KAAK,QAAQ,GAAG,EAChD,iBAAY,QAAQ,EAAE,EAE3B,KAAK,YAAc,GACnB,QAAQ,IAAI,8BAA8B,EAC1C,QAAQ,IAAI,sBAAsB,KAAK,KAAK,EAAE,EAC9C,QAAQ,IAAI,sBAAsB,KAAK,KAAK,EAAE,EAC9C,QAAQ,IAAI,oBAAoB,KAAK,QAAQ,GAAG,EAChD,QAAQ,IAAI,oBAAoB,KAAK,WAAW,EAAE,EAG7C,gBAAa,KAAK,KAAK,SAAS,CACnC,MAAO,IACP,SAAU,KAAK,YACf,cAAe,KACf,KAAM,GACP,EAGD,KAAK,oBAAoB,EAGpB,eAAY,KAAK,KAAK,SAAS,CAClC,MAAO,IACP,SAAU,KAAK,YACf,cAAe,KACf,KAAM,GACP,CACH,CAEQ,aAAoB,CAC1B,GAAI,KAAK,SAAU,OAEnB,KAAM,CAAE,MAAArB,CAAU,OAAK,QAAQ,KAEzBkC,EAAO,GACPC,EAAOnC,EAAQ,GACfoC,EAAI,OAAO,KAAK,QAAQF,EAAMC,CAAI,EAGlCE,EAAU,KAAK,SAAW,GAE1BC,EAAS,KAAK,QAAQ,IAAIF,EAAG,IAAK,QAAQ,EAC5CE,IACFA,EAAO,UAAU,EAAI,EACrBA,EAAO,WAAW,EAAI,EAGlBD,GACFC,EAAO,WAAW,cAAc,EACxB,YAAI,gCAAgCF,CAAC,EAAE,IAE/CE,EAAO,WAAW,QAAQ,EAClB,YAAI,gCAAgCF,CAAC,EAAE,GAG1CE,EAAA,KAAK,SAAS,EAAI,IACzBA,EAAO,KAAK,SAAS,EAAI,OAAO,KAAK,QAAQ,IAAK,EAAE,EAG7CA,EAAA,KAAK,sBAAsB,EAAI,EAC/BA,EAAA,KAAK,UAAU,CAAC,EAGhBA,EAAA,QAAQ,cAAe,EAAI,EAC3BA,EAAA,QAAQ,UAAWD,CAAO,EAErC,CAEQ,qBAA4B,CAClC,GAAI,KAAK,SAAU,OAGnB,MAAME,EAAW,IACXC,EAAW,IAGXC,EAAS,KAAK,SACdC,EAAoB,KAAK,IAAID,EAAQ,GAAG,EACxCE,EAAcJ,GAAYC,EAAWD,GAAYG,EAEvD,QAAQ,IAAI,iCAAiCC,EAAc,KAAM,QAAQ,CAAC,CAAC,GAAG,EAEzE,kBAAe,KAAK,KAAK,SAAS,CACrC,MAAOA,EACP,SAAU,IAAM,CACd,KAAK,aAAa,EAClB,KAAK,oBAAoB,CAC3B,EACA,cAAe,KAChB,CACH,CAEQ,cAAqB,CAC3B,GAAI,KAAK,SAAU,OAEnB,KAAM,CAAE,MAAA3C,CAAU,OAAK,QAAQ,KAEzBkC,EAAO,GACPC,EAAOnC,EAAQ,GACfoC,EAAI,OAAO,KAAK,QAAQF,EAAMC,CAAI,EAElCS,EAAU,KAAK,SAAS,IAAIR,EAAG,IAAK,cAAc,EACxD,GAAIQ,EAAS,CACXA,EAAQ,UAAU,EAAI,EACtBA,EAAQ,WAAW,EAAI,EAGvB,MAAMC,EAAY,OAAO,KAAK,QAAQ,IAAK,GAAG,EACxCC,EAAY,OAAO,KAAK,QAAQ,IAAK,EAAE,EAErCF,EAAA,KAAK,SAAS,EAAIC,EAClBD,EAAA,KAAK,SAAS,EAAIE,EAGlBF,EAAA,KAAK,sBAAsB,EAAI,EAC/BA,EAAA,KAAK,UAAU,CAAC,EAGhBA,EAAA,QAAQ,cAAe,EAAI,EAEnC,QAAQ,IAAI,2BAA2BR,CAAC,kBAAkBU,CAAS,KAAKD,CAAS,GAAG,CACtF,CACF,CAEQ,YAAYE,EAAcT,EAAmB,CAEnD,GAAI,CAACA,EAAO,OAAQ,OAEd,MAAAD,EAAUC,EAAO,QAAQ,SAAS,EAWpC,GAVJ,QAAQ,IAAI,wBAAwB,EACpC,QAAQ,IAAI,mBAAmBD,EAAU,iBAAmB,gBAAgB,EAAE,EAC9E,QAAQ,IAAI,oBAAoB,KAAK,WAAW,EAAE,EAClD,QAAQ,IAAI,0BAA0B,KAAK,KAAK,EAAE,EAG7C,aAAQ,YAAYC,CAAM,EAC/BA,EAAO,UAAU,EAAK,EACtBA,EAAO,WAAW,EAAK,EAEnBD,GAAW,CAAC,KAAK,YAEnB,QAAQ,IAAI,wDAAwD,EACpE,KAAK,SAAS,MACT,CAEL,KAAK,OAAS,EACR,MAAAhB,EAAIL,EAAgB,iBACrB,eAAU,QAAQ,GAAGK,EAAE,KAAK,KAAK,KAAK,KAAK,EAAE,EAC1C,YAAI,KAAKgB,EAAU,iCAAmC,cAAc,6BAA6B,KAAK,KAAK,EAAE,CACvH,CACF,CAEQ,aAAaU,EAAcH,EAAoB,CAEhDA,EAAQ,SAEb,QAAQ,IAAI,wBAAwB,EACpC,QAAQ,IAAI,4BAA4B,KAAK,KAAK,EAAE,EAG/C,cAAS,YAAYA,CAAO,EACjCA,EAAQ,UAAU,EAAK,EACvBA,EAAQ,WAAW,EAAK,EAGxB,KAAK,oBAAoB,EAEzB,QAAQ,IAAI,gEAAgE,KAAK,KAAK,EAAE,EAC1F,CAEQ,UAAiB,CACvB,GAAI,KAAK,SAAU,OAGb,MAAAI,EAAQ,IAAI,MAAQ,QAC1B,QAAQ,KAAK,qBAAqB,EAClC,QAAQ,KAAK,oBAAoB,KAAK,KAAK,EAAE,EACrC,aAAK,kBAAmBA,GAAA,YAAAA,EAAO,MAAM;AAAA,GAAM,MAAM,EAAG,EAAE,EAC9D,QAAQ,KAAK,oBAAoB,KAAK,WAAW,EAAE,EAEnD,KAAK,OAAS,EACd,KAAK,mBAAmB,EAExB,QAAQ,KAAK,mBAAmB,KAAK,KAAK,EAAE,EAExC,KAAK,OAAS,IAChB,QAAQ,KAAK,mCAAmC,EAChD,KAAK,QAAQ,EAEjB,CAEQ,oBAA2B,CACjC,MAAMrB,EAAS,KAAK,OAAO,KAAK,KAAK,EAC/BN,EAAIL,EAAgB,iBAC1B,KAAK,UAAU,QAAQ,GAAGK,EAAE,KAAK,KAAKM,CAAM,EAAE,CAChD,CAEQ,aAAoB,CAC1B,GAAI,KAAK,SAAU,OAEnB,KAAK,UAAY,EACX,MAAAN,EAAIL,EAAgB,iBACrB,eAAU,QAAQ,GAAGK,EAAE,IAAI,KAAK,KAAK,QAAQ,GAAG,EAEjD,KAAK,UAAY,GACnB,KAAK,QAAQ,CAEjB,CAEQ,qBAA4B,CAClC,KAAK,YAAc,GACnB,KAAK,gBAAkB,GAGjB,MAAAA,EAAIL,EAAgB,iBACrB,iBAAY,QAAQ,KAAKK,EAAE,OAAO,KAAK,KAAK,eAAe,GAAG,EAG/D,KAAK,cACP,KAAK,aAAa,UAGf,kBAAe,KAAK,KAAK,SAAS,CACrC,MAAO,IACP,SAAU,KAAK,kBACf,cAAe,KACf,KAAM,GACP,CACH,CAEQ,mBAA0B,CAChC,GAAI,CAAC,KAAK,YAAa,OAEvB,KAAK,iBAAmB,EAClB,MAAAA,EAAIL,EAAgB,iBACrB,iBAAY,QAAQ,KAAKK,EAAE,OAAO,KAAK,KAAK,eAAe,GAAG,EAE/D,KAAK,iBAAmB,GAC1B,KAAK,sBAAsB,CAE/B,CAEQ,uBAA8B,CACpC,KAAK,YAAc,GACnB,KAAK,gBAAkB,EAClB,iBAAY,QAAQ,EAAE,EAEvB,KAAK,cACP,KAAK,aAAa,UAGpB,QAAQ,IAAI,6BAA6B,CAC3C,CAEQ,SAAgB,CACtB,KAAK,SAAW,GAChB,KAAK,YAAc,GAGf,KAAK,YAAY,KAAK,WAAW,UACjC,KAAK,cAAc,KAAK,aAAa,UACrC,KAAK,WAAW,KAAK,UAAU,UAC/B,KAAK,cAAc,KAAK,aAAa,UAGzC,KAAK,sBAAsB,EAG3B,KAAM,CAAE,MAAArB,EAAO,OAAAC,CAAO,EAAI,KAAK,QAAQ,KACjCoB,EAAIL,EAAgB,iBAEpBiC,EAAe,KAAK,IAAI,KAAKjD,EAAQ,EAAGC,EAAS,EAAGoB,EAAE,SAAU,CACpE,SAAU,KAAK,IAAI,GAAIrB,EAAQ,GAAI,EAAI,KACvC,MAAO,UACP,WAAY,QACb,EAAE,UAAU,EAAG,EAEVkD,EAAiB,KAAK,IAAI,KAAKlD,EAAQ,EAAGC,EAAS,EAAI,GAAI,GAAGoB,EAAE,UAAU,KAAK,KAAK,KAAK,GAAI,CACjG,SAAU,KAAK,IAAI,GAAIrB,EAAQ,GAAI,EAAI,KACvC,MAAO,UACP,WAAY,QACb,EAAE,UAAU,EAAG,EAEVmD,EAAc,KAAK,IAAI,KAAKnD,EAAQ,EAAGC,EAAS,EAAI,IAAKoB,EAAE,eAAgB,CAC/E,SAAU,KAAK,IAAI,GAAIrB,EAAQ,IAAK,EAAI,KACxC,MAAO,UACP,WAAY,QACb,EAAE,UAAU,EAAG,EAGhB,KAAK,cAAc,KAAKiD,EAAcC,EAAgBC,CAAW,EAEjE,QAAQ,IAAI,8BAA8B,KAAK,KAAK,EAAE,CACxD,CAEA,QAAe,WACb,GAAI,KAAK,SAAU,OAEnB,KAAM,CAAE,MAAAnD,EAAO,OAAAC,CAAO,EAAI,KAAK,QAAQ,KAGjCmD,GAAUtB,EAAA,KAAK,MAAM,WAAX,YAAAA,EAAqB,mBACrC,GAAIsB,EAAS,CACX,MAAMpB,EAAS,KAAK,IAAI,GAAIhC,EAAQ,GAAI,EAClCqD,EAAQ,KAAK,IAAI,EAAGrD,EAAQ,IAAK,GACnCsD,EAAAF,EAAQ,OAAR,MAAAE,EAAc,OACX,eAAU,EAAI,KAAK,IAAItB,EAAQ,KAAK,UAAU,EAAIqB,CAAK,GACnDE,EAAAH,EAAQ,QAAR,MAAAG,EAAe,SACnB,eAAU,EAAI,KAAK,IAAIvD,EAAQgC,EAAQ,KAAK,UAAU,EAAIqB,CAAK,EAExE,CAGA,KAAK,QAAQ,SAAS,QAAQ,QAASf,GAAgB,CACrD,GAAIA,EAAO,QAAUA,EAAO,QAAQ,aAAa,GAE3CA,EAAO,GAAKrC,EAAS,GAAI,CACrB,MAAAoC,EAAUC,EAAO,QAAQ,SAAS,EACxC,QAAQ,IAAI,kBAAkBD,EAAU,QAAU,OAAO,mCAAmC,EAEvF,aAAQ,YAAYC,CAAM,EAC/BA,EAAO,UAAU,EAAK,EACtBA,EAAO,WAAW,EAAK,CAEzB,CACF,CACD,EAGD,KAAK,SAAS,SAAS,QAAQ,QAASM,GAAiB,CACnDA,EAAQ,QAAUA,EAAQ,QAAQ,aAAa,GAE7CA,EAAQ,GAAK3C,EAAS,KACnB,cAAS,YAAY2C,CAAO,EACjCA,EAAQ,UAAU,EAAK,EACvBA,EAAQ,WAAW,EAAK,EAG5B,CACD,EAGG,CAAC,KAAK,aAAe,CAAC,KAAK,UAAY,KAAK,KAAK,IAAM,KACzD,KAAK,UAAU,CAEnB,CAEA,UAAiB,CACX,KAAK,YACP,KAAK,WAAW,UAEd,KAAK,cACP,KAAK,aAAa,UAEhB,KAAK,WACP,KAAK,UAAU,UAEb,KAAK,cACP,KAAK,aAAa,UAIhB,KAAK,wBACS5B,EAAA,kBAAkB,KAAK,sBAAsB,CAEjE,CACF,CCrkBA,MAAMwC,EAAgC,CACpC,KAAM,OAAO,KACb,MAAO,IACP,OAAQ,IACR,OAAQ,iBACR,gBAAiB,UACjB,MAAO,CACL,KAAM,OAAO,MAAM,IACnB,WAAY,OAAO,MAAM,YACzB,IAAK,CACH,MAAO,IACP,OAAQ,GACV,EACA,IAAK,CACH,MAAO,KACP,OAAQ,GACV,CACF,EACA,QAAS,CACP,QAAS,SACT,OAAQ,CACN,QAAS,CAAE,EAAG,EAAG,EAAG,GAAI,EACxB,MAAO,EACT,CACF,EACA,MAAO,CAAC1D,EAAW4B,CAAS,CAC9B,EAGA,IAAI+B,EAAoB,KAEjB,SAASC,GAAuB,CACrC,OAAID,GACFA,EAAK,QAAQ,EAAI,EAGZA,EAAA,IAAIE,OAAKH,CAAM,EAOfC,CACT,CAEO,SAASG,GAAuB,CAC9B,OAAAH,CACT,CAEO,SAASI,GAAoB,CAC9BJ,IACFA,EAAK,QAAQ,EAAI,EACVA,EAAA,KAEX,CCzDA,MAAMK,EAAc,GAAgB,kBAC9BC,EAAkB,GAAgB,uBAExC,QAAQ,IAAI,wBAAyB,CACnC,IAAKD,EAAc,MAAQ,UAC3B,IAAKC,EAAkB,MAAQ,UAC/B,IAAK,CAAY,qDACnB,CAAC,EAED,GAAI,CAACD,GAAe,CAACC,EACnB,cAAQ,MAAM,sBAAuB,CAAE,YAAAD,EAAa,gBAAAC,CAAiB,GAC/D,IAAI,MAAM,+CAA+C,CAAC,CAACD,CAAW,SAAS,CAAC,CAACC,CAAe,EAAE,EAuC7F,MAAAC,EAAWC,EAAuBH,EAAaC,EAAiB,CAC3E,KAAM,CACJ,iBAAkB,GAClB,eAAgB,GAChB,mBAAoB,EACtB,CACF,CAAC,EASYG,EAAiB,CAC5B,MAAM,WAAWC,EAAyC,CACpD,IACF,KAAM,CAAE,KAAAC,EAAM,MAAAC,CAAA,EAAU,MAAML,EAC3B,KAAK,UAAU,EACf,OAAO,GAAG,EACV,GAAG,KAAMG,CAAM,EACf,cAEH,OAAIE,GACM,cAAM,0BAA2BA,CAAK,EACvC,MAGFD,QACAC,EAAO,CACN,qBAAM,2BAA4BA,CAAK,EACxC,IACT,CACF,EAEA,MAAM,cAAcC,EAAsF,CACpG,IACI,MAAE,KAAAF,EAAM,MAAAC,CAAA,EAAU,MAAML,EAC3B,KAAK,UAAU,EACf,OAAOM,EAAgB,CACtB,WAAY,KACZ,iBAAkB,GACnB,EACA,SACA,SAEH,OAAID,GACM,cAAM,0BAA2BA,CAAK,EACvC,MAGFD,QACAC,EAAO,CACN,qBAAM,8BAA+BA,CAAK,EAC3C,IACT,CACF,EAEA,MAAM,cAAcF,EAAgBI,EAA+E,CAC7G,IACF,KAAM,CAAE,KAAAH,EAAM,MAAAC,GAAU,MAAML,EAC3B,KAAK,UAAU,EAEf,OAAOO,CAAO,EACd,GAAG,KAAMJ,CAAM,EACf,SACA,SAEH,OAAIE,GACM,cAAM,0BAA2BA,CAAK,EACvC,MAGFD,QACAC,EAAO,CACN,qBAAM,4BAA6BA,CAAK,EACzC,IACT,CACF,EAEA,MAAM,0BAA0BG,EAAkBC,EAA0C,CACtF,IACF,GAAI,CAACD,GAAYA,EAAS,KAAK,EAAE,SAAW,EACnC,SAGT,MAAME,EAAQV,EACX,KAAK,UAAU,EACf,OAAO,IAAI,EACX,GAAG,WAAmBQ,EAAS,KAAM,GAEpCC,GACIC,EAAA,IAAI,KAAMD,CAAa,EAG/B,KAAM,CAAE,KAAAL,EAAM,MAAAC,CAAM,EAAI,MAAMK,EAE9B,OAAIL,GACM,cAAM,wCAAyCA,CAAK,EACrD,IAGFD,EAAK,SAAW,QAChBC,EAAO,CACN,qBAAM,yCAA0CA,CAAK,EACtD,EACT,CACF,CACF,ECtJO,MAAMM,CAAY,CAavB,aAAc,CAZNnE,EAAA,aAAmB,CACzB,KAAM,KACN,QAAS,KACT,QAAS,KACT,UAAW,GACX,gBAAiB,GACjB,oBAAqB,KAGfA,EAAA,iBAA+C,IAC/CA,EAAA,wBAAmB,IAGzB,KAAK,eAAe,EACpB,KAAK,mBAAmB,CAC1B,CAEA,MAAc,gBAAgC,CACxC,IACF,QAAQ,IAAI,yBAAyB,EAG/B,MAAAoE,EAAiBZ,EAAS,KAAK,WAAW,EAC1Ca,EAAiB,IAAI,QAAe,CAACC,EAAGC,IAC5C,WAAW,IAAMA,EAAO,IAAI,MAAM,iBAAiB,CAAC,EAAG,GAAI,GAGvD,CAAE,KAAM,CAAE,QAAAC,CAAA,EAAW,MAAAX,CAAU,QAAM,QAAQ,KAAK,CAACO,EAAgBC,CAAc,CAAC,EAEpFR,GACM,cAAM,yBAA0BA,CAAK,EAG3CW,GACF,QAAQ,IAAI,qCAAqC,EAC3C,WAAK,iBAAiBA,CAAO,GAEnC,QAAQ,IAAI,sBAAsB,QAG7BX,EAAO,CACN,cAAM,6BAA8BA,CAAK,SACjD,CACA,KAAK,MAAM,UAAY,GACvB,KAAK,gBAAgB,EACrB,QAAQ,IAAI,gCAAgC,CAC9C,CACF,CAEQ,oBAA2B,CACjCL,EAAS,KAAK,kBAAkB,MAAOiB,EAAOD,IAAY,CAGxD,OAFQ,YAAI,wBAAyBC,CAAK,EAElCA,EAAO,CACb,IAAK,YACCD,GACI,WAAK,iBAAiBA,CAAO,EAErC,MAEF,IAAK,aACH,KAAK,eAAe,EACpB,MAEF,IAAK,kBACCA,IACF,KAAK,MAAM,QAAUA,EAChB,WAAM,KAAOA,EAAQ,MAE5B,KACJ,CAEA,KAAK,gBAAgB,EACtB,CACH,CAEA,MAAc,iBAAiBA,EAAiC,SAC9D,GAAI,KAAK,iBAAkB,CACzB,QAAQ,IAAI,wCAAwC,EACpD,MACF,CAEA,KAAK,iBAAmB,GAEpB,IACF,QAAQ,IAAI,+BAAgCA,EAAQ,KAAK,KAAK,EAE9D,KAAK,MAAM,QAAUA,EAChB,WAAM,KAAOA,EAAQ,KAC1B,KAAK,MAAM,gBAAkB,GAG7B,IAAIV,EAAU,MAAMJ,EAAe,WAAWc,EAAQ,KAAK,EAAE,EAExDV,IACH,QAAQ,IAAI,4BAA4B,EAC9BA,EAAA,MAAMJ,EAAe,cAAc,CAC3C,MAAOc,EAAQ,KAAK,OAAS,GAC7B,WAAUlD,EAAAkD,EAAQ,KAAK,gBAAb,YAAAlD,EAA4B,SAC7BwB,EAAA0B,EAAQ,KAAK,gBAAb,YAAA1B,EAA4B,YAAa,KAClD,kBAAmB,GACnB,kBAAmB,KACpB,GAGH,KAAK,MAAM,QAAUgB,EAChB,WAAM,qBAAsBA,GAAA,YAAAA,EAAS,oBAAqB,GAE/D,QAAQ,IAAI,8BAA+B,CACzC,MAAOU,EAAQ,KAAK,MACpB,WAAY,CAAC,CAACV,EACd,WAAY,KAAK,MAAM,oBACxB,QAEMD,EAAO,CACN,cAAM,2BAA4BA,CAAK,SAC/C,CACA,KAAK,MAAM,UAAY,GACvB,KAAK,iBAAmB,EAC1B,CACF,CAEQ,gBAAuB,CAC7B,KAAK,MAAQ,CACX,KAAM,KACN,QAAS,KACT,QAAS,KACT,UAAW,GACX,gBAAiB,GACjB,oBAAqB,GAEzB,CAEQ,iBAAwB,CACzB,eAAU,QAAoBa,GAAA,CAC7B,IACFA,EAAS,KAAK,KAAK,QACZb,EAAO,CACN,cAAM,0BAA2BA,CAAK,CAChD,EACD,CACH,CAGO,UAAUa,EAAkD,CAC5D,sBAAU,KAAKA,CAAQ,EAC5BA,EAAS,KAAK,KAAK,EAEZ,IAAM,CACX,MAAMC,EAAQ,KAAK,UAAU,QAAQD,CAAQ,EACzCC,EAAQ,IACL,eAAU,OAAOA,EAAO,CAAC,CAChC,CAEJ,CAEO,UAAsB,CACpB,OAAE,GAAG,KAAK,MACnB,CAEO,SAAmB,CACjB,OAAC,KAAK,MAAM,SACrB,CAEO,aAAuB,CAC5B,OAAO,KAAK,MAAM,eACpB,CAEO,qBAA+B,CACpC,OAAO,KAAK,MAAM,iBAAmB,KAAK,MAAM,mBAClD,CAEA,MAAa,kBAAkE,CACzE,IACF,KAAM,CAAE,MAAAd,CAAM,EAAI,MAAML,EAAS,KAAK,gBAAgB,CACpD,SAAU,SACX,EAED,OAAIK,GACM,cAAM,wBAAyBA,CAAK,EACrC,CAAE,QAAS,GAAO,MAAOA,EAAM,OAAQ,GAGzC,CAAE,QAAS,UAEXA,EAAO,CACN,qBAAM,4BAA6BA,CAAK,EACzC,CAAE,QAAS,GAAO,MAAO,iCAAkC,CACpE,CACF,CAEA,MAAa,cAAce,EAA8D,CACnF,IACF,KAAM,CAAE,MAAAf,CAAM,EAAI,MAAML,EAAS,KAAK,cAAc,CAClD,MAAAoB,CAAA,CACD,EAED,OAAIf,GACM,cAAM,qBAAsBA,CAAK,EAClC,CAAE,QAAS,GAAO,MAAOA,EAAM,OAAQ,GAGzC,CAAE,QAAS,UAEXA,EAAO,CACN,qBAAM,yBAA0BA,CAAK,EACtC,CAAE,QAAS,GAAO,MAAO,iCAAkC,CACpE,CACF,CAEA,MAAa,UAAUe,EAAeC,EAA8D,CAC9F,IACF,KAAM,CAAE,MAAAhB,CAAM,EAAI,MAAML,EAAS,KAAK,UAAU,CAC9C,MAAAoB,EACA,MAAAC,EACA,KAAM,QACP,EAED,OAAIhB,GACM,cAAM,0BAA2BA,CAAK,EACvC,CAAE,QAAS,GAAO,MAAOA,EAAM,OAAQ,GAGzC,CAAE,QAAS,UAEXA,EAAO,CACN,qBAAM,8BAA+BA,CAAK,EAC3C,CAAE,QAAS,GAAO,MAAO,sCAAuC,CACzE,CACF,CAEA,MAAa,SAAyB,CAChC,IACF,KAAM,CAAE,MAAAA,CAAM,EAAI,MAAML,EAAS,KAAK,QAAQ,EAC1C,GAAAK,EAAa,MAAAA,QACVA,EAAO,CACN,oBAAM,kBAAmBA,CAAK,EAChCA,CACR,CACF,CAEA,MAAa,cAAcE,EAAoD,CACzE,IAAC,KAAK,MAAM,KACR,UAAI,MAAM,uBAAuB,EAGrC,IACI,MAAAD,EAAU,MAAMJ,EAAe,cAAc,KAAK,MAAM,KAAK,GAAIK,CAAO,EAE9E,OAAID,IACF,KAAK,MAAM,QAAUA,EAEjB,sBAAuBC,IACpB,WAAM,oBAAsBD,EAAQ,mBAG3C,KAAK,gBAAgB,GAGhBA,QAEAD,EAAO,CACN,oBAAM,wBAAyBA,CAAK,EACtCA,CACR,CACF,CAEA,MAAa,gBAAgC,CACvC,GAAC,KAAK,MAAM,KAEZ,IACF,MAAMC,EAAU,MAAMJ,EAAe,WAAW,KAAK,MAAM,KAAK,EAAE,EAC9DI,IACF,KAAK,MAAM,QAAUA,EAChB,WAAM,oBAAsBA,EAAQ,kBACzC,KAAK,gBAAgB,SAEhBD,EAAO,CACN,cAAM,yBAA0BA,CAAK,CAC/C,CACF,CAEO,SAAgB,CACrB,KAAK,UAAY,EACnB,CACF,CAGa,MAAAiB,EAAc,IAAIX,EAGlBY,EAAc,SAA8B,CAGnD,GAFJ,QAAQ,IAAI,qCAAqC,EAE7CD,EAAY,cACd,eAAQ,IAAI,kBAAkB,EACvB,GAgBL,GAbCA,EAAY,YACf,QAAQ,IAAI,qCAAqC,EAC3C,UAAI,QAAyBE,GAAA,CACjC,MAAMC,EAAcH,EAAY,UAAWI,GAAU,CAC9CA,EAAM,YACGD,IACJD,IACV,CACD,EACF,GAIC,CAACF,EAAY,cACf,eAAQ,IAAI,0BAA0B,EAC/B,IAAI,QAAkBE,GAAY,CAEvCG,EAAA,WAAO,yBAAiB,EAAE,iGAAK,CAAC,CAAE,UAAAC,KAAgB,CAC1C,MAAAC,EAAQ,IAAID,EACZC,EAAA,OAAQC,GAAY,CACxBD,EAAM,QAAQ,EACNL,EAAAM,GAAWR,EAAY,YAAa,GAC7C,EACDO,EAAM,KAAK,EACZ,EAAE,MAAexB,GAAA,CACR,cAAM,4BAA6BA,CAAK,EAChDmB,EAAQ,EAAK,EACd,EACF,EAGG,MAAAO,EAAUT,EAAY,cACpB,mBAAI,8BAA+BS,CAAO,EAC3CA,CACT,ECnVI,IAAIC,EAAa,GAGjB,SAASC,GAAqB,CAE5B,SAASC,GAAqB,CAC5B,MAAMC,EAAcnF,EAAgB,eAAgB,EACpD,SAAS,iBAAiB,aAAa,EAAE,QAAQoF,GAAW,CAC1D,MAAMvF,EAAMuF,EAAQ,aAAa,WAAW,EACxCvF,GAAOA,KAAOsF,IACZtF,IAAQ,iBAEVwF,EAAsB,EAEtBD,EAAQ,YAAcD,EAAYtF,CAAG,EAGnD,CAAS,EAGD,MAAMyF,EAAU,SAAS,eAAe,cAAc,EACtD,GAAIA,EAAS,CACX,MAAMC,EAAcvF,EAAgB,mBAAoB,EACxDsF,EAAQ,YAAc,MAAMC,EAAY,YAAa,GACtD,CAGD,MAAMC,EAAU,SAAS,eAAe,eAAe,EACvD,GAAIA,EAAS,CACX,MAAMC,EAAgBhF,EAAiB,wBAAyB,EAChE+E,EAAQ,YAAc,MAAMC,CAAa,EAC1C,CAGD,SAAS,gBAAgB,KAAOzF,EAAgB,mBAAoB,CACrE,CAGD,SAASqF,GAAuB,CAC9B,MAAMK,EAAgB,SAAS,cAAc,8BAA8B,EAC3E,GAAIA,EAAe,CACjB,MAAMP,EAAcnF,EAAgB,eAAgB,EAC9CyF,EAAgBhF,EAAiB,wBAAyB,EAChEiF,EAAc,YAAcP,EAAY,wBAAwB,QAAQ,cAAeM,CAAa,CACrG,CACF,CAGDzF,EAAgB,iBAAiBkF,CAAkB,EAGnDzE,EAAiB,kBAAkB,IAAM,CACvC4E,EAAsB,EAEtB,MAAMG,EAAU,SAAS,eAAe,eAAe,EACvD,GAAIA,EAAS,CACX,MAAMC,EAAgBhF,EAAiB,wBAAyB,EAChE+E,EAAQ,YAAc,MAAMC,CAAa,EAC1C,CACT,CAAO,EAGDP,EAAoB,CACrB,CAGD,OAAO,aAAe,gBAAiB,CAKrC,GAJA,QAAQ,IAAI,yBAAyB,EAIjC,CADY,MAAMX,EAAa,EACrB,CACZ,QAAQ,IAAI,gDAAgD,EAC5D,MACD,CAED,QAAQ,IAAI,wCAAwC,EAE/B3B,EAAS,IAE5B,QAAQ,IAAI,sCAAsC,EAClDC,EAAa,GAEfH,EAAgB,CACjB,EAED,OAAO,YAAc,UAAW,CAC9B,MAAMD,EAAOG,EAAS,EACtB,GAAKH,EAIL,GAFAuC,EAAa,CAACA,EAEVA,EAAY,CACdvC,EAAK,MAAM,MAAM,WAAW,EAC5B,MAAM,EAAIzC,EAAgB,eAAgB,EAC1C,SAAS,cAAc,mBAAmB,EAAE,YAAc,MAAQ,EAAE,OACpE,QAAQ,IAAI,gBAAgB,CACpC,KAAa,CACLyC,EAAK,MAAM,OAAO,WAAW,EAC7B,MAAM,EAAIzC,EAAgB,eAAgB,EAC1C,SAAS,cAAc,mBAAmB,EAAE,YAAc,MAAQ,EAAE,MACpE,QAAQ,IAAI,iBAAiB,CAC9B,CACF,EAED,OAAO,iBAAmB,UAAW,CACnC,MAAMK,EAAIL,EAAgB,eAAgB,EAC1C,MAAM,GAAGK,EAAE,iBAAiB;AAAA;AAAA,EAEhCA,EAAE,qBAAqB;AAAA;AAAA,EAEvBA,EAAE,oBAAoB;AAAA,EACtBA,EAAE,qBAAqB;AAAA,EACvBA,EAAE,qBAAqB;AAAA,EACvBA,EAAE,uBAAuB;AAAA;AAAA,EAEzBA,EAAE,iBAAiB;AAAA,EACnBA,EAAE,wBAAwB;AAAA,EAC1BA,EAAE,wBAAwB;AAAA,EAC1BA,EAAE,wBAAwB;AAAA,EAC1BA,EAAE,iBAAiB;AAAA,EACnBA,EAAE,iBAAiB;AAAA;AAAA,EAEnBA,EAAE,gBAAgB;AAAA,EAClBA,EAAE,sBAAsB;AAAA,EACxBA,EAAE,uBAAuB;AAAA,EACzBA,EAAE,qBAAqB;AAAA;AAAA,EAEvBA,EAAE,oBAAoB,EAAE,CACrB,EAED,OAAO,SAAW,UAAW,CAC3B,QAAQ,IAAI,yBAAyB,EACrC,MAAMA,EAAIL,EAAgB,eAAgB,EAC1C,MAAM,GAAGK,EAAE,aAAa;AAAA;AAAA,EAE5BA,EAAE,gBAAgB;AAAA;AAAA,EAElBA,EAAE,mBAAmB;AAAA;AAAA,EAErBA,EAAE,aAAa;AAAA;AAAA,EAEfA,EAAE,eAAe,EAAE,CAChB,EAED,OAAO,eAAiB,UAAW,CACjCL,EAAgB,eAAgB,EAChC,QAAQ,IAAI,2BAA2BA,EAAgB,mBAAoB,GAAE,CAC9E,EAED,OAAO,eAAiB,UAAW,CACjCS,EAAiB,eAAgB,EACjC,QAAQ,IAAI,4BAA4BA,EAAiB,wBAAyB,GAAE,CACrF,EAGD,IAAIkF,EAAe,KACfC,EAAmB,GACnBC,EAAoB,GAExB,SAASC,GAAsB,CAE7B,GADAH,EAAe/C,EAAS,EACpB,CAAC+C,EAAc,OAEnB,MAAMI,EAAYJ,EAAa,MAAM,SAAS,WAAW,EACzD,GAAKI,EAGL,IAAIH,GAAoBG,EAAU,UAAW,CAC3C,KAAM,CAAE,MAAA/G,CAAK,EAAK+G,EAAU,QAAQ,KAC9B/E,EAAS,KAAK,IAAI,GAAIhC,EAAQ,GAAI,EAClCqD,EAAQ,KAAK,IAAI,EAAGrD,EAAQ,IAAK,EACvC+G,EAAU,UAAU,EAAI,KAAK,IAAI/E,EAAQ+E,EAAU,UAAU,EAAI1D,CAAK,CACvE,CACD,GAAIwD,GAAqBE,EAAU,UAAW,CAC5C,KAAM,CAAE,MAAA/G,CAAK,EAAK+G,EAAU,QAAQ,KAC9B/E,EAAS,KAAK,IAAI,GAAIhC,EAAQ,GAAI,EAClCqD,EAAQ,KAAK,IAAI,EAAGrD,EAAQ,IAAK,EACvC+G,EAAU,UAAU,EAAI,KAAK,IAAI/G,EAAQgC,EAAQ+E,EAAU,UAAU,EAAI1D,CAAK,CAC/E,EACF,CAGD,SAAS,iBAAiB,mBAAoB,UAAW,CACvD,QAAQ,IAAI,yCAAyC,EAGrD4C,EAAoB,EAMpB,MAAMe,EAAY,SAAS,eAAe,YAAY,EAChDC,EAAa,SAAS,eAAe,aAAa,EAEpDD,GAAaC,IAEfD,EAAU,iBAAiB,aAAe,GAAM,CAC9C,EAAE,eAAgB,EAClBJ,EAAmB,EAC7B,CAAS,EACDI,EAAU,iBAAiB,WAAa,GAAM,CAC5C,EAAE,eAAgB,EAClBJ,EAAmB,EAC7B,CAAS,EACDI,EAAU,iBAAiB,YAAc,GAAM,CAC7C,EAAE,eAAgB,EAClBJ,EAAmB,EAC7B,CAAS,EACDI,EAAU,iBAAiB,UAAY,GAAM,CAC3C,EAAE,eAAgB,EAClBJ,EAAmB,EAC7B,CAAS,EAGDK,EAAW,iBAAiB,aAAe,GAAM,CAC/C,EAAE,eAAgB,EAClBJ,EAAoB,EAC9B,CAAS,EACDI,EAAW,iBAAiB,WAAa,GAAM,CAC7C,EAAE,eAAgB,EAClBJ,EAAoB,EAC9B,CAAS,EACDI,EAAW,iBAAiB,YAAc,GAAM,CAC9C,EAAE,eAAgB,EAClBJ,EAAoB,EAC9B,CAAS,EACDI,EAAW,iBAAiB,UAAY,GAAM,CAC5C,EAAE,eAAgB,EAClBJ,EAAoB,EAC9B,CAAS,EAGD,YAAYC,EAAqB,EAAE,EAEtC","names":["BootScene","Scene","width","height","loadingText","progressBg","progressBar","value","translations","_LanguageManager","__publicField","savedLanguage","browserLanguage","language","callback","key","newLanguage","LanguageManager","languageManager","_CharacterManager","savedCharacter","character","char","t","characters","nextIndex","CharacterManager","characterManager","GameScene","hearts","currentCharacter","newCharacter","_a","pointer","margin","text","minX","maxX","x","isGreen","bottle","minDelay","maxDelay","random","exponentialFactor","randomDelay","powerup","velocityY","velocityX","_bucket","stack","gameOverText","finalScoreText","restartText","cursors","speed","_b","_c","config","game","initializeGame","Game","getGame","destroyGame","supabaseUrl","supabaseAnonKey","supabase","createClient","profileService","userId","data","error","profile","updates","nickname","excludeUserId","query","AuthManager","sessionPromise","timeoutPromise","_","reject","session","event","listener","index","email","token","authManager","requireAuth","resolve","unsubscribe","state","__vitePreload","AuthModal","modal","success","canPlay","gamePaused","initializeLanguage","updateTranslations","translation","element","updateFooterControls","langBtn","currentLang","charBtn","characterName","footerElement","gameInstance","touchLeftPressed","touchRightPressed","handleTouchControls","gameScene","touchLeft","touchRight"],"sources":["../../src/scenes/BootScene.ts","../../src/i18n/translations.ts","../../src/i18n/LanguageManager.ts","../../src/systems/CharacterManager.ts","../../src/scenes/GameScene.ts","../../src/main.ts","../../src/systems/SupabaseClient.ts","../../src/systems/AuthManager.ts","../../index.html?html-proxy&index=1.js"],"sourcesContent":["import { Scene } from 'phaser'\n\nexport class BootScene extends Scene {\n  constructor() {\n    super({ key: 'BootScene' })\n  }\n\n  preload(): void {\n    console.log('üîß BootScene: Starting asset loading...')\n\n    // Create simple loading graphics\n    this.createLoadingUI()\n\n    // Load basic game assets - using simple rectangles for now\n    this.load.image('bottle', 'data:image/svg+xml;base64,' + btoa(`\n      <svg width=\"20\" height=\"40\" xmlns=\"http://www.w3.org/2000/svg\">\n        <rect width=\"20\" height=\"40\" fill=\"#8B4513\" stroke=\"#654321\" stroke-width=\"2\"/>\n        <rect x=\"5\" y=\"5\" width=\"10\" height=\"30\" fill=\"#A0522D\"/>\n      </svg>\n    `))\n\n    this.load.image('bottle_green', 'data:image/svg+xml;base64,' + btoa(`\n      <svg width=\"20\" height=\"40\" xmlns=\"http://www.w3.org/2000/svg\">\n        <rect width=\"20\" height=\"40\" fill=\"#228B22\" stroke=\"#006400\" stroke-width=\"2\"/>\n        <rect x=\"5\" y=\"5\" width=\"10\" height=\"30\" fill=\"#32CD32\"/>\n        <text x=\"10\" y=\"25\" text-anchor=\"middle\" fill=\"white\" font-size=\"10\">X</text>\n      </svg>\n    `))\n\n    this.load.image('powerup_star', 'data:image/svg+xml;base64,' + btoa(`\n      <svg width=\"30\" height=\"30\" xmlns=\"http://www.w3.org/2000/svg\">\n        <polygon points=\"15,2 18,10 27,10 20,16 23,25 15,20 7,25 10,16 3,10 12,10\"\n                 fill=\"#FFD700\" stroke=\"#FFA500\" stroke-width=\"2\"/>\n        <circle cx=\"15\" cy=\"15\" r=\"3\" fill=\"#FFFF00\"/>\n      </svg>\n    `))\n\n    // Character sprites - Load real mascot images\n    this.load.image('charlie', '/characters/charlie.png')\n    this.load.image('scrocca', '/characters/scrocca.png')\n    this.load.image('leprecauno', '/characters/leprecauno.png')\n\n    this.load.image('bucket', 'data:image/svg+xml;base64,' + btoa(`\n      <svg width=\"80\" height=\"60\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M10,20 L70,20 L65,55 L15,55 Z\" fill=\"#888888\" stroke=\"#666666\" stroke-width=\"2\"/>\n        <rect x=\"10\" y=\"15\" width=\"60\" height=\"10\" fill=\"#AAAAAA\"/>\n      </svg>\n    `))\n\n    this.load.image('background', 'data:image/svg+xml;base64,' + btoa(`\n      <svg width=\"800\" height=\"600\" xmlns=\"http://www.w3.org/2000/svg\">\n        <defs>\n          <linearGradient id=\"skyGradient\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n            <stop offset=\"0%\" style=\"stop-color:#87CEEB;stop-opacity:1\" />\n            <stop offset=\"100%\" style=\"stop-color:#E0F6FF;stop-opacity:1\" />\n          </linearGradient>\n        </defs>\n        <rect width=\"800\" height=\"600\" fill=\"url(#skyGradient)\"/>\n      </svg>\n    `))\n  }\n\n  create(): void {\n    console.log('‚úÖ BootScene: Assets loaded, transitioning to GameScene')\n\n    // Smooth transition to game\n    this.cameras.main.fadeOut(300, 0, 0, 0)\n    this.cameras.main.once('camerafadeoutcomplete', () => {\n      this.scene.start('GameScene')\n    })\n  }\n\n  private createLoadingUI(): void {\n    const { width, height } = this.cameras.main\n\n    // Loading text\n    const loadingText = this.add.text(width / 2, height / 2 - 50, 'Loading...', {\n      fontSize: '32px',\n      color: '#ffffff',\n      fontFamily: 'Arial'\n    }).setOrigin(0.5)\n\n    // Loading bar background\n    const progressBg = this.add.graphics()\n    progressBg.fillStyle(0x000000, 0.3)\n    progressBg.fillRect(width / 2 - 150, height / 2, 300, 20)\n\n    // Loading bar\n    const progressBar = this.add.graphics()\n\n    // Update loading bar\n    this.load.on('progress', (value: number) => {\n      progressBar.clear()\n      progressBar.fillStyle(0x00ff00)\n      progressBar.fillRect(width / 2 - 150, height / 2, 300 * value, 20)\n    })\n\n    this.load.on('complete', () => {\n      loadingText.setText('Ready!')\n      progressBar.clear()\n      progressBg.clear()\n    })\n  }\n}","export interface Translation {\n  // Homepage\n  title: string\n  subtitle: string\n  version: string\n  newGame: string\n  pause: string\n  resume: string\n  instructions: string\n  testAuth: string\n  footerMadeBy: string\n  footerControls: string\n\n  // Instructions\n  instructionsTitle: string\n  instructionsObjective: string\n  instructionsControls: string\n  instructionsRules: string\n  instructionsTips: string\n  instructionsGoodLuck: string\n  instructionsArrowKeys: string\n  instructionsMouseDrag: string\n  instructionsMobileTouch: string\n  instructionsBrownBottles: string\n  instructionsGreenBottles: string\n  instructionsStarPowerups: string\n  instructionsLives: string\n  instructionsTimer: string\n  instructionsCatchStars: string\n  instructionsAllGoodMode: string\n  instructionsHighScore: string\n\n  // Game UI\n  score: string\n  lives: string\n  time: string\n  allGood: string\n  gameInstructions: string\n  gameRules: string\n  gameOver: string\n  finalScore: string\n  restartMessage: string\n\n  // Auth Modal\n  authWelcome: string\n  authSignInToPlay: string\n  authContinueGoogle: string\n  authContinueEmail: string\n  authEmailTitle: string\n  authEmailSubtitle: string\n  authSendCode: string\n  authBack: string\n  authVerifyTitle: string\n  authVerifySubtitle: string\n  authVerify: string\n  authProfileTitle: string\n  authProfileSubtitle: string\n  authNicknamePlaceholder: string\n  authMarketingConsent: string\n  authStartPlaying: string\n  authProcessing: string\n  authEmailPlaceholder: string\n  authOtpPlaceholder: string\n\n  // Auth Messages\n  authInvalidEmail: string\n  authCodeSent: string\n  authInvalidCode: string\n  authCodeLength: string\n  authFailed: string\n  authUnexpectedError: string\n  authGoogleFailed: string\n  authSendFailed: string\n  authVerifyFailed: string\n  authProfileFailed: string\n\n  // Test Auth\n  testAuthTitle: string\n  testAuthFeatures: string\n  testAuthIntegration: string\n  testAuthReady: string\n  testAuthTryGame: string\n\n  // Character System\n  footerControlsCharacter: string\n  characterCharlie: string\n  characterScrocca: string\n  characterLeprecauno: string\n}\n\nexport const translations = {\n  en: {\n    // Homepage\n    title: 'Etimu√® Bottle Dropper',\n    subtitle: 'Catch the falling bottles!',\n    version: 'v2.0.0 - Clean Architecture',\n    newGame: 'New Game',\n    pause: 'Pause',\n    resume: 'Resume',\n    instructions: 'Instructions',\n    testAuth: 'Test Auth',\n    footerMadeBy: 'Made with ‚ù§Ô∏è by Etimu√®',\n    footerControls: 'Use arrow keys or mouse to control the bucket',\n\n    // Instructions\n    instructionsTitle: 'üéÆ How to Play:',\n    instructionsObjective: 'üéØ Objective: Catch falling bottles with your bucket!',\n    instructionsControls: 'üïπÔ∏è Controls:',\n    instructionsRules: 'üç∂ Game Rules:',\n    instructionsTips: 'üèÜ Tips:',\n    instructionsGoodLuck: 'Good luck! üéÆ',\n    instructionsArrowKeys: '‚Ä¢ Use ‚Üê ‚Üí arrow keys to move',\n    instructionsMouseDrag: '‚Ä¢ Or click and drag with mouse/touch',\n    instructionsMobileTouch: '‚Ä¢ On mobile: Use touch controls at bottom',\n    instructionsBrownBottles: '‚Ä¢ Brown bottles: +1 point each',\n    instructionsGreenBottles: '‚Ä¢ Green bottles: Lose 1 life (unless All Good mode)',\n    instructionsStarPowerups: '‚Ä¢ ‚≠ê Star power-ups: Activate All Good mode',\n    instructionsLives: '‚Ä¢ üíó You have 3 lives',\n    instructionsTimer: '‚Ä¢ ‚è∞ 60 seconds to play',\n    instructionsCatchStars: '‚Ä¢ Catch star power-ups to avoid green bottle damage',\n    instructionsAllGoodMode: '‚Ä¢ All Good mode makes green bottles worth +1 point',\n    instructionsHighScore: '‚Ä¢ Try to get the highest score possible!',\n\n    // Game UI\n    score: 'Score',\n    lives: 'Lives',\n    time: 'Time',\n    allGood: 'ALL GOOD',\n    gameInstructions: 'Use arrow keys or drag to move the bucket!',\n    gameRules: 'üç∂ Catch brown bottles: +1pt | üü¢ Avoid green bottles: -1 life | ‚≠ê Star: All Good!',\n    gameOver: 'GAME OVER!',\n    finalScore: 'Final Score',\n    restartMessage: 'Click \"New Game\" to restart',\n\n    // Auth Modal\n    authWelcome: 'üéÆ Welcome to Etimu√® Bottle Dropper!',\n    authSignInToPlay: 'Sign in to play and compete for prizes',\n    authContinueGoogle: 'Continue with Google',\n    authContinueEmail: 'Continue with Email',\n    authEmailTitle: 'üìß Sign in with Email',\n    authEmailSubtitle: \"We'll send you a verification code\",\n    authSendCode: 'Send Code',\n    authBack: '‚Üê Back',\n    authVerifyTitle: 'üîê Enter Verification Code',\n    authVerifySubtitle: 'Check your email for the 6-digit code',\n    authVerify: 'Verify',\n    authProfileTitle: 'üë§ Setup Your Profile',\n    authProfileSubtitle: 'Choose a nickname for the leaderboard',\n    authNicknamePlaceholder: 'Your nickname',\n    authMarketingConsent: 'I want to receive updates and compete for prizes',\n    authStartPlaying: 'Start Playing!',\n    authProcessing: 'Processing...',\n    authEmailPlaceholder: 'your@email.com',\n    authOtpPlaceholder: '000000',\n\n    // Auth Messages\n    authInvalidEmail: 'Please enter a valid email address',\n    authCodeSent: 'Verification code sent to your email!',\n    authInvalidCode: 'Invalid verification code',\n    authCodeLength: 'Please enter the 6-digit verification code',\n    authFailed: 'Authentication failed, please try again',\n    authUnexpectedError: 'Unexpected error during authentication',\n    authGoogleFailed: 'Google sign in failed',\n    authSendFailed: 'Failed to send verification code',\n    authVerifyFailed: 'Unexpected error during verification',\n    authProfileFailed: 'Failed to update profile',\n\n    // Test Auth\n    testAuthTitle: 'üîê Auth System Demo',\n    testAuthFeatures: 'üì± AuthModal Features:\\n‚úÖ Google OAuth integration\\n‚úÖ Email OTP verification\\n‚úÖ Multi-step flow (Welcome ‚Üí Email ‚Üí Verify ‚Üí Profile)\\n‚úÖ Marketing consent handling\\n‚úÖ Nickname setup\\n‚úÖ Mobile responsive design\\n‚úÖ Glassmorphism UI',\n    testAuthIntegration: 'üéÆ Integration:\\n‚úÖ Game requires auth before play\\n‚úÖ Profile management\\n‚úÖ Score submission ready',\n    testAuthReady: 'The Auth system is 98% complete and ready for production testing!',\n    testAuthTryGame: 'Click \"New Game\" to see auth requirement in action.',\n\n    // Character System\n    footerControlsCharacter: 'Use arrow keys or mouse to control {character}',\n    characterCharlie: 'Charlie',\n    characterScrocca: 'Scrocca',\n    characterLeprecauno: 'Leprechaun'\n  } as Translation,\n\n  it: {\n    // Homepage\n    title: 'Etimu√® Bottle Dropper',\n    subtitle: 'Prendi le bottiglie che cadono!',\n    version: 'v2.0.0 - Architettura Pulita',\n    newGame: 'Nuova Partita',\n    pause: 'Pausa',\n    resume: 'Riprendi',\n    instructions: 'Istruzioni',\n    testAuth: 'Test Auth',\n    footerMadeBy: 'Fatto con ‚ù§Ô∏è da Etimu√®',\n    footerControls: 'Usa le frecce o il mouse per controllare il secchio',\n\n    // Instructions\n    instructionsTitle: 'üéÆ Come Giocare:',\n    instructionsObjective: 'üéØ Obiettivo: Prendi le bottiglie che cadono con il tuo secchio!',\n    instructionsControls: 'üïπÔ∏è Controlli:',\n    instructionsRules: 'üç∂ Regole del Gioco:',\n    instructionsTips: 'üèÜ Suggerimenti:',\n    instructionsGoodLuck: 'Buona fortuna! üéÆ',\n    instructionsArrowKeys: '‚Ä¢ Usa le frecce ‚Üê ‚Üí per muoverti',\n    instructionsMouseDrag: '‚Ä¢ Oppure clicca e trascina con mouse/touch',\n    instructionsMobileTouch: '‚Ä¢ Su mobile: Usa i controlli touch in basso',\n    instructionsBrownBottles: '‚Ä¢ Bottiglie marroni: +1 punto ciascuna',\n    instructionsGreenBottles: '‚Ä¢ Bottiglie verdi: Perdi 1 vita (tranne in modalit√† All Good)',\n    instructionsStarPowerups: '‚Ä¢ ‚≠ê Power-up stella: Attiva modalit√† All Good',\n    instructionsLives: '‚Ä¢ üíó Hai 3 vite',\n    instructionsTimer: '‚Ä¢ ‚è∞ 60 secondi per giocare',\n    instructionsCatchStars: '‚Ä¢ Prendi i power-up stella per evitare danni dalle bottiglie verdi',\n    instructionsAllGoodMode: '‚Ä¢ La modalit√† All Good rende le bottiglie verdi del valore di +1 punto',\n    instructionsHighScore: '‚Ä¢ Cerca di ottenere il punteggio pi√π alto possibile!',\n\n    // Game UI\n    score: 'Punteggio',\n    lives: 'Vite',\n    time: 'Tempo',\n    allGood: 'ALL GOOD',\n    gameInstructions: 'Usa le frecce o trascina per muovere il secchio!',\n    gameRules: 'üç∂ Prendi bottiglie marroni: +1pt | üü¢ Evita bottiglie verdi: -1 vita | ‚≠ê Stella: All Good!',\n    gameOver: 'GAME OVER!',\n    finalScore: 'Punteggio Finale',\n    restartMessage: 'Clicca \"Nuova Partita\" per ricominciare',\n\n    // Auth Modal\n    authWelcome: 'üéÆ Benvenuto su Etimu√® Bottle Dropper!',\n    authSignInToPlay: 'Accedi per giocare e competere per i premi',\n    authContinueGoogle: 'Continua con Google',\n    authContinueEmail: 'Continua con Email',\n    authEmailTitle: 'üìß Accedi con Email',\n    authEmailSubtitle: 'Ti invieremo un codice di verifica',\n    authSendCode: 'Invia Codice',\n    authBack: '‚Üê Indietro',\n    authVerifyTitle: 'üîê Inserisci Codice di Verifica',\n    authVerifySubtitle: 'Controlla la tua email per il codice a 6 cifre',\n    authVerify: 'Verifica',\n    authProfileTitle: 'üë§ Configura il Tuo Profilo',\n    authProfileSubtitle: 'Scegli un nickname per la classifica',\n    authNicknamePlaceholder: 'Il tuo nickname',\n    authMarketingConsent: 'Voglio ricevere aggiornamenti e competere per i premi',\n    authStartPlaying: 'Inizia a Giocare!',\n    authProcessing: 'Elaborazione...',\n    authEmailPlaceholder: 'tua@email.com',\n    authOtpPlaceholder: '000000',\n\n    // Auth Messages\n    authInvalidEmail: 'Inserisci un indirizzo email valido',\n    authCodeSent: 'Codice di verifica inviato alla tua email!',\n    authInvalidCode: 'Codice di verifica non valido',\n    authCodeLength: 'Inserisci il codice di verifica a 6 cifre',\n    authFailed: 'Autenticazione fallita, riprova',\n    authUnexpectedError: 'Errore imprevisto durante l\\'autenticazione',\n    authGoogleFailed: 'Accesso con Google fallito',\n    authSendFailed: 'Invio del codice di verifica fallito',\n    authVerifyFailed: 'Errore imprevisto durante la verifica',\n    authProfileFailed: 'Aggiornamento del profilo fallito',\n\n    // Test Auth\n    testAuthTitle: 'üîê Demo Sistema Auth',\n    testAuthFeatures: 'üì± Funzionalit√† AuthModal:\\n‚úÖ Integrazione Google OAuth\\n‚úÖ Verifica Email OTP\\n‚úÖ Flusso multi-step (Benvenuto ‚Üí Email ‚Üí Verifica ‚Üí Profilo)\\n‚úÖ Gestione consenso marketing\\n‚úÖ Configurazione nickname\\n‚úÖ Design responsive mobile\\n‚úÖ UI Glassmorphism',\n    testAuthIntegration: 'üéÆ Integrazione:\\n‚úÖ Il gioco richiede auth prima di giocare\\n‚úÖ Gestione profilo\\n‚úÖ Invio punteggio pronto',\n    testAuthReady: 'Il sistema Auth √® completo al 98% e pronto per i test di produzione!',\n    testAuthTryGame: 'Clicca \"Nuova Partita\" per vedere l\\'autenticazione in azione.',\n\n    // Character System\n    footerControlsCharacter: 'Usa le frecce o il mouse per controllare {character}',\n    characterCharlie: 'Charlie',\n    characterScrocca: 'Scrocca',\n    characterLeprecauno: 'Leprecauno'\n  } as Translation\n}\n\nexport type Language = keyof typeof translations","import { translations, Language, Translation } from './translations'\n\nexport class LanguageManager {\n  private static instance: LanguageManager\n  private currentLanguage: Language = 'en'\n  private callbacks: Set<(language: Language) => void> = new Set()\n\n  private constructor() {\n    // Initialize from localStorage or browser language\n    const savedLanguage = localStorage.getItem('etimue-language') as Language\n    const browserLanguage = navigator.language.toLowerCase()\n\n    if (savedLanguage && savedLanguage in translations) {\n      this.currentLanguage = savedLanguage\n    } else if (browserLanguage.startsWith('it')) {\n      this.currentLanguage = 'it'\n    } else {\n      this.currentLanguage = 'en'\n    }\n\n    console.log(`üåç Language initialized: ${this.currentLanguage}`)\n  }\n\n  public static getInstance(): LanguageManager {\n    if (!LanguageManager.instance) {\n      LanguageManager.instance = new LanguageManager()\n    }\n    return LanguageManager.instance\n  }\n\n  public getCurrentLanguage(): Language {\n    return this.currentLanguage\n  }\n\n  public setLanguage(language: Language): void {\n    if (language !== this.currentLanguage && language in translations) {\n      this.currentLanguage = language\n      localStorage.setItem('etimue-language', language)\n\n      console.log(`üåç Language changed to: ${language}`)\n\n      // Notify all subscribers\n      this.callbacks.forEach(callback => callback(language))\n    }\n  }\n\n  public getTranslation(): Translation {\n    return translations[this.currentLanguage]\n  }\n\n  public translate(key: keyof Translation): string {\n    return translations[this.currentLanguage][key]\n  }\n\n  public onLanguageChange(callback: (language: Language) => void): void {\n    this.callbacks.add(callback)\n  }\n\n  public offLanguageChange(callback: (language: Language) => void): void {\n    this.callbacks.delete(callback)\n  }\n\n  public toggleLanguage(): void {\n    const newLanguage: Language = this.currentLanguage === 'en' ? 'it' : 'en'\n    this.setLanguage(newLanguage)\n  }\n\n  public getAvailableLanguages(): Language[] {\n    return Object.keys(translations) as Language[]\n  }\n\n  public getLanguageDisplayName(language: Language): string {\n    switch (language) {\n      case 'en': return 'English'\n      case 'it': return 'Italiano'\n      default: return language\n    }\n  }\n}\n\n// Export singleton instance\nexport const languageManager = LanguageManager.getInstance()","import { languageManager } from '../i18n/LanguageManager'\n\nexport type Character = 'charlie' | 'scrocca' | 'leprecauno'\n\nexport interface CharacterInfo {\n  id: Character\n  name: string\n  sprite: string\n  description: string\n}\n\nexport class CharacterManager {\n  private static instance: CharacterManager\n  private currentCharacter: Character = 'charlie'\n  private callbacks: Set<(character: Character) => void> = new Set()\n\n  private constructor() {\n    // Load from localStorage with migration support\n    let savedCharacter = localStorage.getItem('etimue-character') as Character\n\n    // Migration: convert old 'irlandese' to new 'leprecauno'\n    if (savedCharacter === 'irlandese' as any) {\n      savedCharacter = 'leprecauno'\n      localStorage.setItem('etimue-character', savedCharacter)\n      console.log(`üîÑ Migrated character from 'irlandese' to 'leprecauno'`)\n    }\n\n    if (savedCharacter && this.isValidCharacter(savedCharacter)) {\n      this.currentCharacter = savedCharacter\n    }\n\n    console.log(`üê± Character initialized: ${this.currentCharacter}`)\n  }\n\n  public static getInstance(): CharacterManager {\n    if (!CharacterManager.instance) {\n      CharacterManager.instance = new CharacterManager()\n    }\n    return CharacterManager.instance\n  }\n\n  private isValidCharacter(character: string): character is Character {\n    return ['charlie', 'scrocca', 'leprecauno'].includes(character)\n  }\n\n  public getCurrentCharacter(): Character {\n    return this.currentCharacter\n  }\n\n  public setCharacter(character: Character): void {\n    if (character !== this.currentCharacter && this.isValidCharacter(character)) {\n      this.currentCharacter = character\n      localStorage.setItem('etimue-character', character)\n\n      console.log(`üê± Character changed to: ${character}`)\n\n      // Notify all subscribers\n      this.callbacks.forEach(callback => callback(character))\n    }\n  }\n\n  public getCharacterInfo(character?: Character): CharacterInfo {\n    const char = character || this.currentCharacter\n    const t = languageManager.getTranslation()\n\n    switch (char) {\n      case 'charlie':\n        return {\n          id: 'charlie',\n          name: t.characterCharlie,\n          sprite: 'charlie',\n          description: 'Punk cat with attitude'\n        }\n      case 'scrocca':\n        return {\n          id: 'scrocca',\n          name: t.characterScrocca,\n          sprite: 'scrocca',\n          description: 'Party cat who loves fun'\n        }\n      case 'leprecauno':\n        return {\n          id: 'leprecauno',\n          name: t.characterLeprecauno,\n          sprite: 'leprecauno',\n          description: 'Lucky Irish leprechaun cat'\n        }\n      default:\n        return this.getCharacterInfo('charlie')\n    }\n  }\n\n  public getCurrentCharacterName(): string {\n    return this.getCharacterInfo().name\n  }\n\n  public getAllCharacters(): CharacterInfo[] {\n    return ['charlie', 'scrocca', 'leprecauno'].map(char => this.getCharacterInfo(char as Character))\n  }\n\n  public onCharacterChange(callback: (character: Character) => void): void {\n    this.callbacks.add(callback)\n  }\n\n  public offCharacterChange(callback: (character: Character) => void): void {\n    this.callbacks.delete(callback)\n  }\n\n  public cycleCharacter(): void {\n    const characters: Character[] = ['charlie', 'scrocca', 'leprecauno']\n    const currentIndex = characters.indexOf(this.currentCharacter)\n    const nextIndex = (currentIndex + 1) % characters.length\n    this.setCharacter(characters[nextIndex])\n  }\n}\n\n// Export singleton instance\nexport const characterManager = CharacterManager.getInstance()","import { Scene } from 'phaser'\nimport { languageManager } from '../i18n/LanguageManager'\nimport { characterManager } from '../systems/CharacterManager'\n\nexport class GameScene extends Scene {\n  private character!: Phaser.Physics.Arcade.Image\n  private bottles!: Phaser.Physics.Arcade.Group\n  private powerups!: Phaser.Physics.Arcade.Group\n  private score: number = 0\n  private lives: number = 3\n  private timeLeft: number = 60 // 60 seconds game\n  private scoreText!: Phaser.GameObjects.Text\n  private livesText!: Phaser.GameObjects.Text\n  private timerText!: Phaser.GameObjects.Text\n  private powerupText!: Phaser.GameObjects.Text\n  private instructionsText!: Phaser.GameObjects.Text\n  private rulesText!: Phaser.GameObjects.Text\n  private languageChangeCallback?: (language: any) => void\n  private spawnTimer!: Phaser.Time.TimerEvent\n  private powerupTimer!: Phaser.Time.TimerEvent\n  private gameTimer!: Phaser.Time.TimerEvent\n  private allGoodTimer!: Phaser.Time.TimerEvent\n  private gameStarted: boolean = false\n  private gameOver: boolean = false\n  private allGoodMode: boolean = false\n  private allGoodTimeLeft: number = 0\n  private gameOverTexts: Phaser.GameObjects.Text[] = []\n\n  constructor() {\n    super({ key: 'GameScene' })\n  }\n\n  create(): void {\n    console.log('üéÆ GameScene: Initializing game...')\n\n    // Set background\n    const { width, height } = this.cameras.main\n    this.add.image(width / 2, height / 2, 'background')\n\n    this.setupUI()\n    this.setupGameObjects()\n    this.setupInput()\n    this.setupCollisions()\n\n    // Fade in\n    this.cameras.main.fadeIn(300, 0, 0, 0)\n\n    console.log('‚úÖ GameScene: Ready to play!')\n  }\n\n  private setupUI(): void {\n    const { width, height } = this.cameras.main\n    const t = languageManager.getTranslation()\n\n    // Score display\n    this.scoreText = this.add.text(16, 16, `${t.score}: 0`, {\n      fontSize: '24px',\n      color: '#000000',\n      fontFamily: 'Arial'\n    })\n\n    // Lives display\n    this.livesText = this.add.text(16, 50, `${t.lives}: ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è`, {\n      fontSize: '20px',\n      color: '#000000',\n      fontFamily: 'Arial'\n    })\n\n    // Timer display\n    this.timerText = this.add.text(width / 2, 16, `${t.time}: 60s`, {\n      fontSize: '24px',\n      color: '#000000',\n      fontFamily: 'Arial'\n    }).setOrigin(0.5)\n\n    // Power-up indicator - positioned from right edge with right alignment\n    this.powerupText = this.add.text(width - 16, 16, '', {\n      fontSize: '18px',\n      color: '#FFD700',\n      fontFamily: 'Arial'\n    }).setOrigin(1, 0) // Right-aligned\n\n    // Instructions\n    this.instructionsText = this.add.text(width / 2, height * 0.12, t.gameInstructions, {\n      fontSize: Math.min(18, width * 0.025) + 'px',\n      color: '#000000',\n      fontFamily: 'Arial'\n    }).setOrigin(0.5)\n\n    this.rulesText = this.add.text(width / 2, height * 0.16, t.gameRules, {\n      fontSize: Math.min(14, width * 0.018) + 'px',\n      color: '#333333',\n      fontFamily: 'Arial'\n    }).setOrigin(0.5)\n\n    // Listen for language changes and update UI texts\n    this.languageChangeCallback = () => {\n      this.updateUITexts()\n    }\n    languageManager.onLanguageChange(this.languageChangeCallback)\n  }\n\n  private updateUITexts(): void {\n    const t = languageManager.getTranslation()\n\n    // Update score text\n    this.scoreText.setText(`${t.score}: ${this.score}`)\n\n    // Update lives text\n    const hearts = '‚ù§Ô∏è'.repeat(this.lives)\n    this.livesText.setText(`${t.lives}: ${hearts}`)\n\n    // Update timer text\n    this.timerText.setText(`${t.time}: ${this.timeLeft}s`)\n\n    // Update instructions and rules\n    this.instructionsText.setText(t.gameInstructions)\n    this.rulesText.setText(t.gameRules)\n\n    // Update All Good text if active\n    if (this.allGoodMode) {\n      this.powerupText.setText(`‚≠ê ${t.allGood}: ${this.allGoodTimeLeft}s`)\n    }\n  }\n\n  private setupGameObjects(): void {\n    const { width, height } = this.cameras.main\n\n    // Create character (use current selected character)\n    const currentCharacter = characterManager.getCurrentCharacter()\n    this.character = this.physics.add.image(width / 2, height - 80, currentCharacter)\n    this.character.setCollideWorldBounds(true)\n    this.character.setImmovable(true)\n\n    // Scale character appropriately for gameplay\n    this.character.setScale(0.6) // Reduce size to 60%\n\n    // Listen for character changes\n    characterManager.onCharacterChange((newCharacter) => {\n      if (this.character) {\n        this.character.setTexture(newCharacter)\n        console.log(`üê± Character sprite updated to: ${newCharacter}`)\n      }\n    })\n\n    // Create bottles group\n    this.bottles = this.physics.add.group({\n      defaultKey: 'bottle',\n      maxSize: 15\n    })\n\n    // Create powerups group\n    this.powerups = this.physics.add.group({\n      defaultKey: 'powerup_star',\n      maxSize: 3\n    })\n  }\n\n  private setupInput(): void {\n    // Keyboard controls\n    const cursors = this.input.keyboard?.createCursorKeys()\n    if (cursors) {\n      // Handle keyboard input in update loop\n    }\n\n    // Mouse/Touch controls\n    this.input.on('pointermove', (pointer: Phaser.Input.Pointer) => {\n      if (pointer.isDown) {\n        const { width } = this.cameras.main\n        const margin = Math.max(40, width * 0.05) // 5% margin or minimum 40px\n        this.character.x = Phaser.Math.Clamp(pointer.x, margin, width - margin)\n      }\n    })\n\n    this.input.on('pointerdown', () => {\n      // Only allow game start if not in game over state\n      if (!this.gameOver) {\n        this.startGame()\n      }\n    })\n  }\n\n  private setupCollisions(): void {\n    this.physics.add.overlap(\n      this.character,\n      this.bottles,\n      this.catchBottle,\n      undefined,\n      this\n    )\n\n    this.physics.add.overlap(\n      this.character,\n      this.powerups,\n      this.catchPowerup,\n      undefined,\n      this\n    )\n  }\n\n  private startGame(): void {\n    if (this.gameStarted) return\n\n    // Clear any previous game over texts\n    this.gameOverTexts.forEach(text => text.destroy())\n    this.gameOverTexts = []\n\n    // Reset game state for fresh start\n    this.lives = 3\n    this.score = 0\n    this.timeLeft = 60\n    this.gameOver = false\n    this.allGoodMode = false\n    this.allGoodTimeLeft = 0\n\n    // Update UI\n    this.updateLivesDisplay()\n    const t = languageManager.getTranslation()\n    this.scoreText.setText(`${t.score}: ${this.score}`)\n    this.timerText.setText(`${t.time}: ${this.timeLeft}s`)\n    this.powerupText.setText('')\n\n    this.gameStarted = true\n    console.log('üöÄ GAME START DEBUG (RESET):')\n    console.log(`üíó Starting Lives: ${this.lives}`)\n    console.log(`üéØ Starting Score: ${this.score}`)\n    console.log(`‚è∞ Starting Time: ${this.timeLeft}s`)\n    console.log(`‚≠ê All Good Mode: ${this.allGoodMode}`)\n\n    // Start spawning bottles\n    this.spawnTimer = this.time.addEvent({\n      delay: 1000,\n      callback: this.spawnBottle,\n      callbackScope: this,\n      loop: true\n    })\n\n    // Start spawning powerups (random intervals)\n    this.scheduleNextPowerup()\n\n    // Start game timer\n    this.gameTimer = this.time.addEvent({\n      delay: 1000,\n      callback: this.updateTimer,\n      callbackScope: this,\n      loop: true\n    })\n  }\n\n  private spawnBottle(): void {\n    if (this.gameOver) return\n\n    const { width } = this.cameras.main\n    // Ensure bottles spawn well within screen bounds\n    const minX = 60\n    const maxX = width - 60\n    const x = Phaser.Math.Between(minX, maxX)\n\n    // 20% chance for green bottle (poison)\n    const isGreen = Math.random() < 0.2\n\n    const bottle = this.bottles.get(x, -50, 'bottle')\n    if (bottle) {\n      bottle.setActive(true)\n      bottle.setVisible(true)\n\n      // Change texture based on bottle type\n      if (isGreen) {\n        bottle.setTexture('bottle_green')\n        console.log(`üü¢ GREEN bottle spawned at x:${x}`)\n      } else {\n        bottle.setTexture('bottle')\n        console.log(`üç∂ BROWN bottle spawned at x:${x}`)\n      }\n\n      bottle.body.velocity.y = 200\n      bottle.body.velocity.x = Phaser.Math.Between(-50, 50)\n\n      // Set collision bounds to detect when bottle hits ground\n      bottle.body.setCollideWorldBounds(true)\n      bottle.body.setBounce(0)\n\n      // Check for ground collision in update loop\n      bottle.setData('checkGround', true)\n      bottle.setData('isGreen', isGreen)\n    }\n  }\n\n  private scheduleNextPowerup(): void {\n    if (this.gameOver) return\n\n    // More random delay between 5-30 seconds with weighted distribution\n    const minDelay = 5000\n    const maxDelay = 30000\n\n    // Use exponential distribution for more variety (favor shorter intervals but allow long ones)\n    const random = Math.random()\n    const exponentialFactor = Math.pow(random, 1.5) // Creates weighted distribution\n    const randomDelay = minDelay + (maxDelay - minDelay) * exponentialFactor\n\n    console.log(`‚≠ê Next power-up scheduled in ${(randomDelay / 1000).toFixed(1)}s`)\n\n    this.powerupTimer = this.time.addEvent({\n      delay: randomDelay,\n      callback: () => {\n        this.spawnPowerup()\n        this.scheduleNextPowerup() // Schedule the next one\n      },\n      callbackScope: this\n    })\n  }\n\n  private spawnPowerup(): void {\n    if (this.gameOver) return\n\n    const { width } = this.cameras.main\n    // Ensure powerups spawn well within screen bounds\n    const minX = 80\n    const maxX = width - 80\n    const x = Phaser.Math.Between(minX, maxX)\n\n    const powerup = this.powerups.get(x, -30, 'powerup_star')\n    if (powerup) {\n      powerup.setActive(true)\n      powerup.setVisible(true)\n\n      // Random velocity for more dynamic movement\n      const velocityY = Phaser.Math.Between(120, 180)\n      const velocityX = Phaser.Math.Between(-30, 30)\n\n      powerup.body.velocity.y = velocityY\n      powerup.body.velocity.x = velocityX\n\n      // Set collision bounds\n      powerup.body.setCollideWorldBounds(true)\n      powerup.body.setBounce(0)\n\n      // Check for ground collision in update loop\n      powerup.setData('checkGround', true)\n\n      console.log(`‚≠ê Power-up spawned at x:${x} with velocity(${velocityX}, ${velocityY})`)\n    }\n  }\n\n  private catchBottle(_bucket: any, bottle: any): void {\n    // Check if bottle is already inactive to prevent multiple scoring\n    if (!bottle.active) return\n\n    const isGreen = bottle.getData('isGreen')\n    console.log(`üéØ BOTTLE CATCH DEBUG:`)\n    console.log(`üç∂ Bottle type: ${isGreen ? 'GREEN (poison)' : 'BROWN (normal)'}`)\n    console.log(`‚≠ê All Good Mode: ${this.allGoodMode}`)\n    console.log(`üíó Lives before catch: ${this.lives}`)\n\n    // Remove caught bottle immediately\n    this.bottles.killAndHide(bottle)\n    bottle.setActive(false)\n    bottle.setVisible(false)\n\n    if (isGreen && !this.allGoodMode) {\n      // Green bottle without All Good mode = lose life\n      console.log(`üö® GREEN BOTTLE CAUGHT WITHOUT ALL GOOD - LOSING LIFE!`)\n      this.loseLife()\n    } else {\n      // Normal bottle or All Good mode active = gain points\n      this.score += 1\n      const t = languageManager.getTranslation()\n      this.scoreText.setText(`${t.score}: ${this.score}`)\n      console.log(`‚úÖ ${isGreen ? 'Green bottle (All Good active)' : 'Brown bottle'} caught! +1 point. Score: ${this.score}`)\n    }\n  }\n\n  private catchPowerup(_bucket: any, powerup: any): void {\n    // Check if powerup is already inactive\n    if (!powerup.active) return\n\n    console.log(`‚≠ê POWERUP CATCH DEBUG:`)\n    console.log(`üíó Lives before powerup: ${this.lives}`)\n\n    // Remove caught powerup immediately\n    this.powerups.killAndHide(powerup)\n    powerup.setActive(false)\n    powerup.setVisible(false)\n\n    // Activate All Good mode for 10 seconds\n    this.activateAllGoodMode()\n\n    console.log(`‚úÖ Power-up caught! All Good mode activated! Lives unchanged: ${this.lives}`)\n  }\n\n  private loseLife(): void {\n    if (this.gameOver) return\n\n    // Get stack trace to see who called this\n    const stack = new Error().stack\n    console.warn(`üö® LIFE LOST DEBUG:`)\n    console.warn(`üíî Lives before: ${this.lives}`)\n    console.warn(`üîç Called from:`, stack?.split('\\n').slice(1, 4))\n    console.warn(`‚≠ê All Good Mode: ${this.allGoodMode}`)\n\n    this.lives -= 1\n    this.updateLivesDisplay()\n\n    console.warn(`üíî Lives after: ${this.lives}`)\n\n    if (this.lives <= 0) {\n      console.warn(`‚ò†Ô∏è GAME OVER - No lives remaining`)\n      this.endGame()\n    }\n  }\n\n  private updateLivesDisplay(): void {\n    const hearts = '‚ù§Ô∏è'.repeat(this.lives)\n    const t = languageManager.getTranslation()\n    this.livesText.setText(`${t.lives}: ${hearts}`)\n  }\n\n  private updateTimer(): void {\n    if (this.gameOver) return\n\n    this.timeLeft -= 1\n    const t = languageManager.getTranslation()\n    this.timerText.setText(`${t.time}: ${this.timeLeft}s`)\n\n    if (this.timeLeft <= 0) {\n      this.endGame()\n    }\n  }\n\n  private activateAllGoodMode(): void {\n    this.allGoodMode = true\n    this.allGoodTimeLeft = 10\n\n    // Update UI\n    const t = languageManager.getTranslation()\n    this.powerupText.setText(`‚≠ê ${t.allGood}: ${this.allGoodTimeLeft}s`)\n\n    // Start countdown timer\n    if (this.allGoodTimer) {\n      this.allGoodTimer.destroy()\n    }\n\n    this.allGoodTimer = this.time.addEvent({\n      delay: 1000,\n      callback: this.updateAllGoodMode,\n      callbackScope: this,\n      loop: true\n    })\n  }\n\n  private updateAllGoodMode(): void {\n    if (!this.allGoodMode) return\n\n    this.allGoodTimeLeft -= 1\n    const t = languageManager.getTranslation()\n    this.powerupText.setText(`‚≠ê ${t.allGood}: ${this.allGoodTimeLeft}s`)\n\n    if (this.allGoodTimeLeft <= 0) {\n      this.deactivateAllGoodMode()\n    }\n  }\n\n  private deactivateAllGoodMode(): void {\n    this.allGoodMode = false\n    this.allGoodTimeLeft = 0\n    this.powerupText.setText('')\n\n    if (this.allGoodTimer) {\n      this.allGoodTimer.destroy()\n    }\n\n    console.log('‚≠ê All Good mode deactivated')\n  }\n\n  private endGame(): void {\n    this.gameOver = true\n    this.gameStarted = false\n\n    // Stop all timers\n    if (this.spawnTimer) this.spawnTimer.destroy()\n    if (this.powerupTimer) this.powerupTimer.destroy()\n    if (this.gameTimer) this.gameTimer.destroy()\n    if (this.allGoodTimer) this.allGoodTimer.destroy()\n\n    // Deactivate any active powerups\n    this.deactivateAllGoodMode()\n\n    // Show game over message\n    const { width, height } = this.cameras.main\n    const t = languageManager.getTranslation()\n\n    const gameOverText = this.add.text(width / 2, height / 2, t.gameOver, {\n      fontSize: Math.min(48, width * 0.06) + 'px',\n      color: '#ff0000',\n      fontFamily: 'Arial'\n    }).setOrigin(0.5)\n\n    const finalScoreText = this.add.text(width / 2, height / 2 + 50, `${t.finalScore}: ${this.score}`, {\n      fontSize: Math.min(24, width * 0.03) + 'px',\n      color: '#000000',\n      fontFamily: 'Arial'\n    }).setOrigin(0.5)\n\n    const restartText = this.add.text(width / 2, height / 2 + 100, t.restartMessage, {\n      fontSize: Math.min(18, width * 0.025) + 'px',\n      color: '#666666',\n      fontFamily: 'Arial'\n    }).setOrigin(0.5)\n\n    // Store game over texts for cleanup\n    this.gameOverTexts.push(gameOverText, finalScoreText, restartText)\n\n    console.log(`üéÆ Game Over! Final Score: ${this.score}`)\n  }\n\n  update(): void {\n    if (this.gameOver) return\n\n    const { width, height } = this.cameras.main\n\n    // Keyboard controls\n    const cursors = this.input.keyboard?.createCursorKeys()\n    if (cursors) {\n      const margin = Math.max(40, width * 0.05) // 5% margin or minimum 40px\n      const speed = Math.max(5, width * 0.006) // Responsive speed based on screen width\n      if (cursors.left?.isDown) {\n        this.character.x = Math.max(margin, this.character.x - speed)\n      } else if (cursors.right?.isDown) {\n        this.character.x = Math.min(width - margin, this.character.x + speed)\n      }\n    }\n\n    // Check bottles that hit the ground\n    this.bottles.children.entries.forEach((bottle: any) => {\n      if (bottle.active && bottle.getData('checkGround')) {\n        // Check if bottle hit the bottom (ground)\n        if (bottle.y >= height - 20) { // Near bottom of screen\n          const isGreen = bottle.getData('isGreen')\n          console.log(`üåç GROUND HIT: ${isGreen ? 'GREEN' : 'BROWN'} bottle hit ground - NO LIFE LOSS`)\n\n          this.bottles.killAndHide(bottle)\n          bottle.setActive(false)\n          bottle.setVisible(false)\n          // No life loss for bottles hitting ground - only when catching green bottles\n        }\n      }\n    })\n\n    // Check powerups that hit the ground\n    this.powerups.children.entries.forEach((powerup: any) => {\n      if (powerup.active && powerup.getData('checkGround')) {\n        // Check if powerup hit the bottom (ground)\n        if (powerup.y >= height - 20) { // Near bottom of screen\n          this.powerups.killAndHide(powerup)\n          powerup.setActive(false)\n          powerup.setVisible(false)\n          // No penalty for missing powerups\n        }\n      }\n    })\n\n    // Auto-start game after a few seconds if not started\n    if (!this.gameStarted && !this.gameOver && this.time.now > 3000) {\n      this.startGame()\n    }\n  }\n\n  shutdown(): void {\n    if (this.spawnTimer) {\n      this.spawnTimer.destroy()\n    }\n    if (this.powerupTimer) {\n      this.powerupTimer.destroy()\n    }\n    if (this.gameTimer) {\n      this.gameTimer.destroy()\n    }\n    if (this.allGoodTimer) {\n      this.allGoodTimer.destroy()\n    }\n\n    // Cleanup language listener\n    if (this.languageChangeCallback) {\n      languageManager.offLanguageChange(this.languageChangeCallback)\n    }\n  }\n}","import { Game, Types } from 'phaser'\nimport { BootScene } from '@/scenes/BootScene'\nimport { GameScene } from '@/scenes/GameScene'\n\n// Game configuration\nconst config: Types.Core.GameConfig = {\n  type: Phaser.AUTO,\n  width: 800,\n  height: 600,\n  parent: 'game-container',\n  backgroundColor: '#87CEEB',\n  scale: {\n    mode: Phaser.Scale.FIT,\n    autoCenter: Phaser.Scale.CENTER_BOTH,\n    min: {\n      width: 300,\n      height: 400\n    },\n    max: {\n      width: 1200,\n      height: 900\n    }\n  },\n  physics: {\n    default: 'arcade',\n    arcade: {\n      gravity: { x: 0, y: 300 },\n      debug: false\n    }\n  },\n  scene: [BootScene, GameScene]\n}\n\n// Initialize game\nlet game: Game | null = null\n\nexport function initializeGame(): Game {\n  if (game) {\n    game.destroy(true)\n  }\n\n  game = new Game(config)\n\n  // Development helper - only expose in dev mode\n  if (import.meta.env?.MODE === 'development') {\n    (window as any).game = game\n  }\n\n  return game\n}\n\nexport function getGame(): Game | null {\n  return game\n}\n\nexport function destroyGame(): void {\n  if (game) {\n    game.destroy(true)\n    game = null\n  }\n}\n\n// DO NOT auto-initialize - wait for user to click GIOCA\n// This prevents double initialization issues\n// Game will be initialized via startNewGame() function in index.html","import { createClient } from '@supabase/supabase-js'\n\n// Environment variables\nconst supabaseUrl = import.meta.env.VITE_SUPABASE_URL\nconst supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY\n\nconsole.log('üîç Environment check:', {\n  url: supabaseUrl ? 'SET' : 'MISSING',\n  key: supabaseAnonKey ? 'SET' : 'MISSING',\n  env: import.meta.env\n})\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  console.error('‚ùå Missing env vars:', { supabaseUrl, supabaseAnonKey })\n  throw new Error(`Missing Supabase environment variables: URL=${!!supabaseUrl}, KEY=${!!supabaseAnonKey}`)\n}\n\n// Database types\nexport interface Profile {\n  id: string\n  email: string\n  nickname: string | null\n  consent_marketing: boolean\n  consent_timestamp: string | null\n  created_at: string\n}\n\nexport interface Score {\n  id: number\n  user_id: string\n  score: number\n  run_seconds: number\n  created_at: string\n}\n\nexport interface Database {\n  public: {\n    Tables: {\n      profiles: {\n        Row: Profile\n        Insert: Omit<Profile, 'id' | 'created_at'>\n        Update: Partial<Omit<Profile, 'id' | 'created_at'>>\n      }\n      scores: {\n        Row: Score\n        Insert: Omit<Score, 'id' | 'created_at'>\n        Update: Partial<Omit<Score, 'id' | 'created_at'>>\n      }\n    }\n  }\n}\n\n// Create Supabase client\nexport const supabase = createClient<Database>(supabaseUrl, supabaseAnonKey, {\n  auth: {\n    autoRefreshToken: true,\n    persistSession: true,\n    detectSessionInUrl: true\n  }\n})\n\n// Check if user is admin\nexport const isAdmin = (userId: string): boolean => {\n  const adminUuids = import.meta.env.VITE_ADMIN_UUIDS?.split(',') || []\n  return adminUuids.includes(userId)\n}\n\n// Profile service\nexport const profileService = {\n  async getProfile(userId: string): Promise<Profile | null> {\n    try {\n      const { data, error } = await supabase\n        .from('profiles')\n        .select('*')\n        .eq('id', userId)\n        .maybeSingle()\n\n      if (error) {\n        console.error('Error fetching profile:', error)\n        return null\n      }\n\n      return data as Profile | null\n    } catch (error) {\n      console.error('Profile fetch exception:', error)\n      return null\n    }\n  },\n\n  async createProfile(profile: Database['public']['Tables']['profiles']['Insert']): Promise<Profile | null> {\n    try {\n      const { data, error } = await supabase\n        .from('profiles')\n        .upsert(profile as any, {\n          onConflict: 'id',\n          ignoreDuplicates: false\n        })\n        .select()\n        .single()\n\n      if (error) {\n        console.error('Error creating profile:', error)\n        return null\n      }\n\n      return data as Profile\n    } catch (error) {\n      console.error('Profile creation exception:', error)\n      return null\n    }\n  },\n\n  async updateProfile(userId: string, updates: Partial<Omit<Profile, 'id' | 'created_at'>>): Promise<Profile | null> {\n    try {\n      const { data, error } = await supabase\n        .from('profiles')\n        // @ts-ignore - Temporary fix for type inference issue\n        .update(updates)\n        .eq('id', userId)\n        .select()\n        .single()\n\n      if (error) {\n        console.error('Error updating profile:', error)\n        return null\n      }\n\n      return data\n    } catch (error) {\n      console.error('Profile update exception:', error)\n      return null\n    }\n  },\n\n  async checkNicknameAvailability(nickname: string, excludeUserId?: string): Promise<boolean> {\n    try {\n      if (!nickname || nickname.trim().length === 0) {\n        return true // Empty nicknames are allowed\n      }\n\n      const query = supabase\n        .from('profiles')\n        .select('id')\n        .eq('nickname' as any, nickname.trim())\n\n      if (excludeUserId) {\n        query.neq('id', excludeUserId)\n      }\n\n      const { data, error } = await query\n\n      if (error) {\n        console.error('Error checking nickname availability:', error)\n        return false\n      }\n\n      return data.length === 0\n    } catch (error) {\n      console.error('Nickname availability check exception:', error)\n      return false\n    }\n  }\n}\n\n// Score service\nexport const scoreService = {\n  async submitScore(userId: string, score: number, runSeconds: number): Promise<Score | null> {\n    try {\n      // Get current session for authorization\n      const { data: { session }, error: sessionError } = await supabase.auth.getSession()\n\n      if (sessionError || !session) {\n        console.error('No valid session for score submission')\n        return null\n      }\n\n      // Try Edge Function first (server-side validation)\n      try {\n        const { data, error } = await supabase.functions.invoke('submit-score', {\n          body: {\n            score,\n            runSeconds,\n            gameEndTimestamp: Date.now()\n          },\n          headers: {\n            Authorization: `Bearer ${session.access_token}`\n          }\n        })\n\n        if (error) throw error\n\n        if (data.success) {\n          console.log('Score submitted via Edge Function:', data.storedScore)\n          return {\n            id: data.storedScore.id,\n            user_id: userId,\n            score: data.storedScore.score,\n            run_seconds: data.storedScore.runSeconds,\n            created_at: new Date().toISOString()\n          }\n        }\n      } catch (edgeError) {\n        console.warn('Edge Function failed, using fallback:', edgeError)\n      }\n\n      // Fallback to direct database submission with client-side validation\n      if (score < 0 || score > 600) {\n        console.error('Invalid score range:', score)\n        return null\n      }\n\n      if (runSeconds < 5) {\n        console.error('Game too short, likely invalid:', runSeconds)\n        return null\n      }\n\n      const { data, error } = await supabase\n        .from('scores')\n        .insert({\n          user_id: userId,\n          score,\n          run_seconds: runSeconds\n        } as any)\n        .select()\n        .single()\n\n      if (error) {\n        console.error('Database error submitting score:', error)\n        return null\n      }\n\n      console.log('Score submitted via direct database:', data)\n      return data as Score\n\n    } catch (error) {\n      console.error('Score submission error:', error)\n      return null\n    }\n  },\n\n  async getWeeklyLeaderboard(limit: number = 50): Promise<Array<Score & { nickname: string }>> {\n    try {\n      // Calculate start of current week (Monday 00:00)\n      const now = new Date()\n      const dayOfWeek = now.getDay() || 7 // Make Sunday = 7\n      const startOfWeek = new Date(now)\n      startOfWeek.setDate(now.getDate() - dayOfWeek + 1)\n      startOfWeek.setHours(0, 0, 0, 0)\n\n      const { data, error } = await supabase\n        .from('scores')\n        .select(`\n          *,\n          profiles (nickname)\n        `)\n        .gte('created_at', startOfWeek.toISOString())\n        .order('score', { ascending: false })\n        .order('created_at', { ascending: true })\n        .limit(limit)\n\n      if (error) {\n        console.error('Error fetching weekly leaderboard:', error)\n        return []\n      }\n\n      return (data as any[]).map(item => ({\n        ...item,\n        nickname: item.profiles?.nickname || 'Anonymous'\n      }))\n    } catch (error) {\n      console.error('Weekly leaderboard exception:', error)\n      return []\n    }\n  },\n\n  async getMonthlyLeaderboard(limit: number = 50): Promise<Array<Score & { nickname: string }>> {\n    try {\n      // Calculate start of current month\n      const now = new Date()\n      const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1)\n\n      const { data, error } = await supabase\n        .from('scores')\n        .select(`\n          *,\n          profiles (nickname)\n        `)\n        .gte('created_at', startOfMonth.toISOString())\n        .order('score', { ascending: false })\n        .order('created_at', { ascending: true })\n        .limit(limit)\n\n      if (error) {\n        console.error('Error fetching monthly leaderboard:', error)\n        return []\n      }\n\n      return (data as any[]).map(item => ({\n        ...item,\n        nickname: item.profiles?.nickname || 'Anonymous'\n      }))\n    } catch (error) {\n      console.error('Monthly leaderboard exception:', error)\n      return []\n    }\n  }\n}","import { supabase, profileService, type Profile } from './SupabaseClient'\nimport type { User, Session } from '@supabase/supabase-js'\n\nexport interface AuthState {\n  user: User | null\n  profile: Profile | null\n  session: Session | null\n  isLoading: boolean\n  isAuthenticated: boolean\n  hasMarketingConsent: boolean\n}\n\nexport class AuthManager {\n  private state: AuthState = {\n    user: null,\n    profile: null,\n    session: null,\n    isLoading: true,\n    isAuthenticated: false,\n    hasMarketingConsent: false\n  }\n\n  private listeners: Array<(state: AuthState) => void> = []\n  private isProcessingAuth = false\n\n  constructor() {\n    this.initializeAuth()\n    this.setupAuthListeners()\n  }\n\n  private async initializeAuth(): Promise<void> {\n    try {\n      console.log('üîÑ Initializing auth...')\n\n      // Get current session with timeout\n      const sessionPromise = supabase.auth.getSession()\n      const timeoutPromise = new Promise<never>((_, reject) =>\n        setTimeout(() => reject(new Error('Session timeout')), 5000)\n      )\n\n      const { data: { session }, error } = await Promise.race([sessionPromise, timeoutPromise])\n\n      if (error) {\n        console.error('Error getting session:', error)\n      }\n\n      if (session) {\n        console.log('‚úÖ Session found, processing auth...')\n        await this.handleAuthChange(session)\n      } else {\n        console.log('‚ÑπÔ∏è No active session')\n      }\n\n    } catch (error) {\n      console.error('Auth initialization error:', error)\n    } finally {\n      this.state.isLoading = false\n      this.notifyListeners()\n      console.log('‚úÖ Auth initialization complete')\n    }\n  }\n\n  private setupAuthListeners(): void {\n    supabase.auth.onAuthStateChange(async (event, session) => {\n      console.log('üîÑ Auth state change:', event)\n\n      switch (event) {\n        case 'SIGNED_IN':\n          if (session) {\n            await this.handleAuthChange(session)\n          }\n          break\n\n        case 'SIGNED_OUT':\n          this.resetAuthState()\n          break\n\n        case 'TOKEN_REFRESHED':\n          if (session) {\n            this.state.session = session\n            this.state.user = session.user\n          }\n          break\n      }\n\n      this.notifyListeners()\n    })\n  }\n\n  private async handleAuthChange(session: Session): Promise<void> {\n    if (this.isProcessingAuth) {\n      console.log('‚è≥ Already processing auth, skipping...')\n      return\n    }\n\n    this.isProcessingAuth = true\n\n    try {\n      console.log('üë§ Processing auth for user:', session.user.email)\n\n      this.state.session = session\n      this.state.user = session.user\n      this.state.isAuthenticated = true\n\n      // Load or create profile\n      let profile = await profileService.getProfile(session.user.id)\n\n      if (!profile) {\n        console.log('üìù Creating new profile...')\n        profile = await profileService.createProfile({\n          email: session.user.email || '',\n          nickname: session.user.user_metadata?.name ||\n                   session.user.user_metadata?.full_name || null,\n          consent_marketing: false,\n          consent_timestamp: null\n        })\n      }\n\n      this.state.profile = profile\n      this.state.hasMarketingConsent = profile?.consent_marketing || false\n\n      console.log('‚úÖ Auth processing complete:', {\n        email: session.user.email,\n        hasProfile: !!profile,\n        hasConsent: this.state.hasMarketingConsent\n      })\n\n    } catch (error) {\n      console.error('‚ùå Error processing auth:', error)\n    } finally {\n      this.state.isLoading = false\n      this.isProcessingAuth = false\n    }\n  }\n\n  private resetAuthState(): void {\n    this.state = {\n      user: null,\n      profile: null,\n      session: null,\n      isLoading: false,\n      isAuthenticated: false,\n      hasMarketingConsent: false\n    }\n  }\n\n  private notifyListeners(): void {\n    this.listeners.forEach(listener => {\n      try {\n        listener(this.state)\n      } catch (error) {\n        console.error('Error in auth listener:', error)\n      }\n    })\n  }\n\n  // Public API\n  public subscribe(listener: (state: AuthState) => void): () => void {\n    this.listeners.push(listener)\n    listener(this.state) // Immediate call with current state\n\n    return () => {\n      const index = this.listeners.indexOf(listener)\n      if (index > -1) {\n        this.listeners.splice(index, 1)\n      }\n    }\n  }\n\n  public getState(): AuthState {\n    return { ...this.state }\n  }\n\n  public isReady(): boolean {\n    return !this.state.isLoading\n  }\n\n  public canPlayGame(): boolean {\n    return this.state.isAuthenticated\n  }\n\n  public canCompeteForPrizes(): boolean {\n    return this.state.isAuthenticated && this.state.hasMarketingConsent\n  }\n\n  public async signInWithGoogle(): Promise<{ success: boolean, error?: string }> {\n    try {\n      const { error } = await supabase.auth.signInWithOAuth({\n        provider: 'google'\n      })\n\n      if (error) {\n        console.error('Google sign in error:', error)\n        return { success: false, error: error.message }\n      }\n\n      return { success: true }\n\n    } catch (error) {\n      console.error('Google sign in exception:', error)\n      return { success: false, error: 'Unexpected error during sign in' }\n    }\n  }\n\n  public async signInWithOTP(email: string): Promise<{ success: boolean, error?: string }> {\n    try {\n      const { error } = await supabase.auth.signInWithOtp({\n        email\n      })\n\n      if (error) {\n        console.error('OTP sign in error:', error)\n        return { success: false, error: error.message }\n      }\n\n      return { success: true }\n\n    } catch (error) {\n      console.error('OTP sign in exception:', error)\n      return { success: false, error: 'Unexpected error during sign in' }\n    }\n  }\n\n  public async verifyOTP(email: string, token: string): Promise<{ success: boolean, error?: string }> {\n    try {\n      const { error } = await supabase.auth.verifyOtp({\n        email,\n        token,\n        type: 'email'\n      })\n\n      if (error) {\n        console.error('OTP verification error:', error)\n        return { success: false, error: error.message }\n      }\n\n      return { success: true }\n\n    } catch (error) {\n      console.error('OTP verification exception:', error)\n      return { success: false, error: 'Unexpected error during verification' }\n    }\n  }\n\n  public async signOut(): Promise<void> {\n    try {\n      const { error } = await supabase.auth.signOut()\n      if (error) throw error\n    } catch (error) {\n      console.error('Sign out error:', error)\n      throw error\n    }\n  }\n\n  public async updateProfile(updates: Partial<Profile>): Promise<Profile | null> {\n    if (!this.state.user) {\n      throw new Error('No authenticated user')\n    }\n\n    try {\n      const profile = await profileService.updateProfile(this.state.user.id, updates)\n\n      if (profile) {\n        this.state.profile = profile\n\n        if ('consent_marketing' in updates) {\n          this.state.hasMarketingConsent = profile.consent_marketing\n        }\n\n        this.notifyListeners()\n      }\n\n      return profile\n\n    } catch (error) {\n      console.error('Profile update error:', error)\n      throw error\n    }\n  }\n\n  public async refreshProfile(): Promise<void> {\n    if (!this.state.user) return\n\n    try {\n      const profile = await profileService.getProfile(this.state.user.id)\n      if (profile) {\n        this.state.profile = profile\n        this.state.hasMarketingConsent = profile.consent_marketing\n        this.notifyListeners()\n      }\n    } catch (error) {\n      console.error('Profile refresh error:', error)\n    }\n  }\n\n  public destroy(): void {\n    this.listeners = []\n  }\n}\n\n// Global instance\nexport const authManager = new AuthManager()\n\n// Helper to require authentication before playing\nexport const requireAuth = async (): Promise<boolean> => {\n  console.log('üéÆ Checking auth for game access...')\n\n  if (authManager.canPlayGame()) {\n    console.log('‚úÖ User can play!')\n    return true\n  }\n\n  if (!authManager.isReady()) {\n    console.log('‚è≥ Waiting for auth to initialize...')\n    await new Promise<void>(resolve => {\n      const unsubscribe = authManager.subscribe((state) => {\n        if (!state.isLoading) {\n          unsubscribe()\n          resolve()\n        }\n      })\n    })\n  }\n\n  // If still not authenticated, show auth modal\n  if (!authManager.canPlayGame()) {\n    console.log('üîê Showing auth modal...')\n    return new Promise<boolean>((resolve) => {\n      // Dynamic import to avoid circular dependency\n      import('../ui/AuthModal').then(({ AuthModal }) => {\n        const modal = new AuthModal()\n        modal.onAuth((success) => {\n          modal.destroy()\n          resolve(success && authManager.canPlayGame())\n        })\n        modal.show()\n      }).catch(error => {\n        console.error('Failed to load AuthModal:', error)\n        resolve(false)\n      })\n    })\n  }\n\n  const canPlay = authManager.canPlayGame()\n  console.log('üéØ Final auth check result:', canPlay)\n  return canPlay\n}","\n    import { initializeGame, getGame, destroyGame } from './src/main.ts'\n    import { requireAuth } from './src/systems/AuthManager.ts'\n    import { languageManager } from './src/i18n/LanguageManager.ts'\n    import { characterManager } from './src/systems/CharacterManager.ts'\n\n    // Global game state\n    let gamePaused = false\n\n    // Initialize language system\n    function initializeLanguage() {\n      // Update all elements with data-i18n attributes\n      function updateTranslations() {\n        const translation = languageManager.getTranslation()\n        document.querySelectorAll('[data-i18n]').forEach(element => {\n          const key = element.getAttribute('data-i18n')\n          if (key && key in translation) {\n            if (key === 'footerControls') {\n              // Special handling for character-aware footer\n              updateFooterControls()\n            } else {\n              element.textContent = translation[key]\n            }\n          }\n        })\n\n        // Update language button\n        const langBtn = document.getElementById('language-btn')\n        if (langBtn) {\n          const currentLang = languageManager.getCurrentLanguage()\n          langBtn.textContent = `üåç ${currentLang.toUpperCase()}`\n        }\n\n        // Update character button\n        const charBtn = document.getElementById('character-btn')\n        if (charBtn) {\n          const characterName = characterManager.getCurrentCharacterName()\n          charBtn.textContent = `üê± ${characterName}`\n        }\n\n        // Update page language attribute\n        document.documentElement.lang = languageManager.getCurrentLanguage()\n      }\n\n      // Update footer with current character name\n      function updateFooterControls() {\n        const footerElement = document.querySelector('[data-i18n=\"footerControls\"]')\n        if (footerElement) {\n          const translation = languageManager.getTranslation()\n          const characterName = characterManager.getCurrentCharacterName()\n          footerElement.textContent = translation.footerControlsCharacter.replace('{character}', characterName)\n        }\n      }\n\n      // Set up language change listener\n      languageManager.onLanguageChange(updateTranslations)\n\n      // Set up character change listener\n      characterManager.onCharacterChange(() => {\n        updateFooterControls()\n        // Update character button text\n        const charBtn = document.getElementById('character-btn')\n        if (charBtn) {\n          const characterName = characterManager.getCurrentCharacterName()\n          charBtn.textContent = `üê± ${characterName}`\n        }\n      })\n\n      // Initial translation update\n      updateTranslations()\n    }\n\n    // GLOBAL FUNCTIONS FOR BUTTONS\n    window.startNewGame = async function() {\n      console.log('üéÆ Starting new game...')\n\n      // Check authentication first\n      const canPlay = await requireAuth()\n      if (!canPlay) {\n        console.log('‚ùå User not authenticated, game start cancelled')\n        return\n      }\n\n      console.log('‚úÖ User authenticated, starting game...')\n      // Only destroy if game exists to avoid unnecessary recreation\n      const existingGame = getGame()\n      if (existingGame) {\n        console.log('üîÑ Destroying existing game instance')\n        destroyGame()\n      }\n      initializeGame()\n    }\n\n    window.togglePause = function() {\n      const game = getGame()\n      if (!game) return\n\n      gamePaused = !gamePaused\n\n      if (gamePaused) {\n        game.scene.pause('GameScene')\n        const t = languageManager.getTranslation()\n        document.querySelector('.btn:nth-child(2)').textContent = '‚ñ∂Ô∏è ' + t.resume\n        console.log('‚è∏Ô∏è Game paused')\n      } else {\n        game.scene.resume('GameScene')\n        const t = languageManager.getTranslation()\n        document.querySelector('.btn:nth-child(2)').textContent = '‚è∏Ô∏è ' + t.pause\n        console.log('‚ñ∂Ô∏è Game resumed')\n      }\n    }\n\n    window.showInstructions = function() {\n      const t = languageManager.getTranslation()\n      alert(`${t.instructionsTitle}\n\n${t.instructionsObjective}\n\n${t.instructionsControls}\n${t.instructionsArrowKeys}\n${t.instructionsMouseDrag}\n${t.instructionsMobileTouch}\n\n${t.instructionsRules}\n${t.instructionsBrownBottles}\n${t.instructionsGreenBottles}\n${t.instructionsStarPowerups}\n${t.instructionsLives}\n${t.instructionsTimer}\n\n${t.instructionsTips}\n${t.instructionsCatchStars}\n${t.instructionsAllGoodMode}\n${t.instructionsHighScore}\n\n${t.instructionsGoodLuck}`)\n    }\n\n    window.testAuth = function() {\n      console.log('üß™ Testing auth flow...')\n      const t = languageManager.getTranslation()\n      alert(`${t.testAuthTitle}\n\n${t.testAuthFeatures}\n\n${t.testAuthIntegration}\n\n${t.testAuthReady}\n\n${t.testAuthTryGame}`)\n    }\n\n    window.toggleLanguage = function() {\n      languageManager.toggleLanguage()\n      console.log(`üåç Language toggled to: ${languageManager.getCurrentLanguage()}`)\n    }\n\n    window.cycleCharacter = function() {\n      characterManager.cycleCharacter()\n      console.log(`üê± Character changed to: ${characterManager.getCurrentCharacterName()}`)\n    }\n\n    // Mobile touch controls\n    let gameInstance = null\n    let touchLeftPressed = false\n    let touchRightPressed = false\n\n    function handleTouchControls() {\n      gameInstance = getGame()\n      if (!gameInstance) return\n\n      const gameScene = gameInstance.scene.getScene('GameScene')\n      if (!gameScene) return\n\n      // Simulate keyboard input\n      if (touchLeftPressed && gameScene.character) {\n        const { width } = gameScene.cameras.main\n        const margin = Math.max(40, width * 0.05)\n        const speed = Math.max(5, width * 0.006)\n        gameScene.character.x = Math.max(margin, gameScene.character.x - speed)\n      }\n      if (touchRightPressed && gameScene.character) {\n        const { width } = gameScene.cameras.main\n        const margin = Math.max(40, width * 0.05)\n        const speed = Math.max(5, width * 0.006)\n        gameScene.character.x = Math.min(width - margin, gameScene.character.x + speed)\n      }\n    }\n\n    // Auto-initialize when page loads\n    document.addEventListener('DOMContentLoaded', function() {\n      console.log('üöÄ Etimu√® Bottle Dropper v2.0.0 loaded!')\n\n      // Initialize language system\n      initializeLanguage()\n\n      // DO NOT initialize game here - wait for user to click GIOCA\n      // initializeGame() - REMOVED to fix double initialization bug\n\n      // Setup mobile touch controls\n      const touchLeft = document.getElementById('touch-left')\n      const touchRight = document.getElementById('touch-right')\n\n      if (touchLeft && touchRight) {\n        // Left button events\n        touchLeft.addEventListener('touchstart', (e) => {\n          e.preventDefault()\n          touchLeftPressed = true\n        })\n        touchLeft.addEventListener('touchend', (e) => {\n          e.preventDefault()\n          touchLeftPressed = false\n        })\n        touchLeft.addEventListener('mousedown', (e) => {\n          e.preventDefault()\n          touchLeftPressed = true\n        })\n        touchLeft.addEventListener('mouseup', (e) => {\n          e.preventDefault()\n          touchLeftPressed = false\n        })\n\n        // Right button events\n        touchRight.addEventListener('touchstart', (e) => {\n          e.preventDefault()\n          touchRightPressed = true\n        })\n        touchRight.addEventListener('touchend', (e) => {\n          e.preventDefault()\n          touchRightPressed = false\n        })\n        touchRight.addEventListener('mousedown', (e) => {\n          e.preventDefault()\n          touchRightPressed = true\n        })\n        touchRight.addEventListener('mouseup', (e) => {\n          e.preventDefault()\n          touchRightPressed = false\n        })\n\n        // Continuous movement loop\n        setInterval(handleTouchControls, 16) // ~60fps\n      }\n    })\n  "],"file":"assets/index-4633465e.js"}